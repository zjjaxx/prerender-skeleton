{"version":3,"sources":["/Users/zhengjiajun/zjj/learn/prerender-skeleton/packages/skeleton/dist/skeleton.js","../src/skeleton.ts","../src/utils/skeletonUtil.ts"],"names":["__defProp","Object","defineProperty","__getOwnPropDesc","getOwnPropertyDescriptor","__getOwnPropNames","getOwnPropertyNames","__hasOwnProp","prototype","hasOwnProperty","__export","target","all","name","get","enumerable","__copyProps","to","from","except","desc","key","call","__toCommonJS","mod","value","skeleton_exports","default","SkeletonRender","module","exports","cloneElementWithUniqueIds","element","prefix","clonedElement","cloneNode","updateIds","el","parentPrefix","id","Array","children","forEach","child","index","removeElement","ele","parent","parentNode","removeChild","inViewPort","rect","getBoundingClientRect","top","window","innerHeight","left","innerWidth","e","hasAttr","attr","hasAttribute","setOpacity","style","opacity","px2rem","px","pxValue","parseInt","htmlElementFontSize","getComputedStyle","document","documentElement","fontSize","emptyHandler","node","innerHTML","classNameArr","className","split","map","item","join","query","styleSheet","styleSheets","href","insertRule","console","log","JSON","stringify","checkHasPseudoEle","beforeComputedStyle","beforeContent","getPropertyValue","beforeWidth","parseFloat","hasBefore","afterComputedStyle","afterContent","afterWidth","hasAfter","width","Math","max","isTextNode","nodeType","Node","TEXT_NODE","nodeValue","isHtmlElement","ELEMENT_NODE","SKELETON_CLONE_CLASS","MOCK_WRAPPER_ID","MAIN_COLOR","MAIN_COLOR_RGB","PSEUDO_CLASS","PSEUDO_CLASS_ANIMATION","BUTTON_CLASS","TRANSPARENT_CLASS","SMALLEST_BASE64","IMG_BASE64_LARGE","IMG_BASE64_MID","IMG_BASE64_SMALL","IMG_BG","SKELETON_TEXT_CLASS","IMG_CLASS_SMALL","IMG_CLASS_MID","IMG_CLASS_LARGE","skeletonStyle","options","assign","debug","animation","appId","minGrayBlockWidth","minGrayPseudoWidth","removeMock","getTextWidthElement","querySelector","remove","genSkeleton","startGenSkeleton","app","newNode","getElementById","error","classList","add","visibility","body","prepend","styleHandler","handleNode","Error","message","stack","skeletonBlockStyleEle","createElement","innerText","replace","contains","textContent","trim","tmpNode","replaceChild","textHandler","ignore","tagName","beforeHandler","pseudoHandler","toUpperCase","scriptHandler","imgHandler","svgHandler","inputHandler","buttonHandler","aHandler","childNodes","length","hasChildNodes","comStyle","display","lineHeight","paddingTop","paddingRight","paddingBottom","paddingLeft","position","pos","textAlign","wordSpacing","wordBreak","test","fontSizeNum","find","p","height","offsetHeight","offsetWidth","lineCount","textHeightRatio","backgroundImage","backgroundSize","addTextMask","parse","textWidth","getTextWidth","textWidthPercent","backgroundPositionX","paragraph","maskWidthPercent","right","mask","background","bottom","appendChild","MOCK_TEXT_ID","offScreenParagraph","wrapper","src","indexOf","backgroundColor","addAnimationForElement","removeAttribute","getAttribute","pseudo","isHidden","ComputedStyle","boxShadow","oldBoxShadow","newBoxShadow","borderColor","bgColor","color"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __defProp = Object.defineProperty;\nvar __getOwnPropDesc = Object.getOwnPropertyDescriptor;\nvar __getOwnPropNames = Object.getOwnPropertyNames;\nvar __hasOwnProp = Object.prototype.hasOwnProperty;\nvar __export = (target, all) => {\n  for (var name in all)\n    __defProp(target, name, { get: all[name], enumerable: true });\n};\nvar __copyProps = (to, from, except, desc) => {\n  if (from && typeof from === \"object\" || typeof from === \"function\") {\n    for (let key of __getOwnPropNames(from))\n      if (!__hasOwnProp.call(to, key) && key !== except)\n        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });\n  }\n  return to;\n};\nvar __toCommonJS = (mod) => __copyProps(__defProp({}, \"__esModule\", { value: true }), mod);\n\n// src/skeleton.ts\nvar skeleton_exports = {};\n__export(skeleton_exports, {\n  default: () => SkeletonRender\n});\nmodule.exports = __toCommonJS(skeleton_exports);\n\n// src/utils/skeletonUtil.ts\nvar cloneElementWithUniqueIds = (element, prefix = \"__clone\") => {\n  const clonedElement = element.cloneNode(true);\n  function updateIds(el, parentPrefix) {\n    if (el.id) {\n      el.id = `${parentPrefix}-${el.id}`;\n    }\n    Array.from(el.children).forEach((child, index) => {\n      updateIds(child, `${parentPrefix}-${index}`);\n    });\n  }\n  updateIds(clonedElement, prefix);\n  return clonedElement;\n};\nvar removeElement = (ele) => {\n  const parent = ele.parentNode;\n  if (parent) {\n    parent.removeChild(ele);\n  }\n};\nvar inViewPort = (ele) => {\n  try {\n    const rect = ele.getBoundingClientRect();\n    return rect.top < window.innerHeight && rect.left < window.innerWidth;\n  } catch (e) {\n    return true;\n  }\n};\nvar hasAttr = (ele, attr) => {\n  try {\n    return ele.hasAttribute(attr);\n  } catch (e) {\n    return false;\n  }\n};\nvar setOpacity = (ele) => {\n  if (ele.style) {\n    ele.style.opacity = 0;\n  }\n};\nvar px2rem = (px) => {\n  const pxValue = typeof px === \"string\" ? parseInt(px, 10) : px;\n  const htmlElementFontSize = window.getComputedStyle(\n    document.documentElement\n  ).fontSize;\n  return `${pxValue / parseInt(htmlElementFontSize, 10)}rem`;\n};\nvar emptyHandler = (node) => {\n  node.innerHTML = \"\";\n  let classNameArr = node.className && node.className.split(\" \") || [];\n  classNameArr = classNameArr.map((item) => {\n    return \".\" + item;\n  });\n  const className = classNameArr.join(\"\");\n  const id = node.id ? \"#\" + node.id : \"\";\n  const query = className || id;\n  if (!query) return;\n  let styleSheet;\n  for (const item of document.styleSheets) {\n    if (!item.href) {\n      styleSheet = item;\n      break;\n    }\n  }\n  try {\n    styleSheet && styleSheet.insertRule(\n      `${query}::before{content:'' !important;background:none !important;}`,\n      0\n    );\n    styleSheet && styleSheet.insertRule(\n      `${query}::after{content:'' !important;background:none !important;}`,\n      0\n    );\n  } catch (e) {\n    console.log(\"handleEmptyNode Error: \", JSON.stringify(e));\n  }\n};\nvar checkHasPseudoEle = (ele) => {\n  if (!ele) return false;\n  const beforeComputedStyle = window.getComputedStyle(ele, \"::before\");\n  const beforeContent = beforeComputedStyle.getPropertyValue(\"content\");\n  const beforeWidth = parseFloat(beforeComputedStyle.getPropertyValue(\"width\")) || 0;\n  const hasBefore = beforeContent && beforeContent !== \"none\";\n  const afterComputedStyle = window.getComputedStyle(ele, \"::after\");\n  const afterContent = afterComputedStyle.getPropertyValue(\"content\");\n  const afterWidth = parseFloat(afterComputedStyle.getPropertyValue(\"width\")) || 0;\n  const hasAfter = afterContent && afterContent !== \"none\";\n  const width = Math.max(beforeWidth, afterWidth);\n  if (hasBefore || hasAfter) {\n    return { hasBefore, hasAfter, ele, width };\n  }\n  return false;\n};\nvar isTextNode = (node) => {\n  return node.nodeType === Node.TEXT_NODE && node.nodeValue !== \"\";\n};\nvar isHtmlElement = (node) => {\n  return node.nodeType === Node.ELEMENT_NODE;\n};\n\n// src/skeleton.ts\nvar SKELETON_CLONE_CLASS = \"skeleton_clone\";\nvar MOCK_WRAPPER_ID = \"skeleton-text-wrapper-id\";\nvar MAIN_COLOR = \"#EEEEEE\";\nvar MAIN_COLOR_RGB = \"rgb(238, 238, 238)\";\nvar PSEUDO_CLASS = \"sk-pseudo\";\nvar PSEUDO_CLASS_ANIMATION = \"sk-pseudo-animation\";\nvar BUTTON_CLASS = \"sk-button\";\nvar TRANSPARENT_CLASS = \"sk-transparent\";\nvar SMALLEST_BASE64 = \"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\";\nvar IMG_BASE64_LARGE = \"data:image/image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAAopJREFUeF7tm1FyAyEIhs3JWk/W5mSmJ2tDRjtmBwUU3HXXPGUmG8P/gYJobu7ir9vF9TsWgBDCp3PuK8KC90d/3cFA7/03ZSgJIIQQnHMziMa03ikIVQBP7UAweZ6CedTPH/5JoWRcEcBJxCfdwOCBQZAAgAEgpNCBjuL+bL3Kp20xCmoAfjeiihSPIj7ZESHA2pVe/QC89+SCeSQQIYQ3B5bsZ0fAAiCIAKRuYOdlrSjaLQKIuoHMy1MDYKbOal6eFgBTPJmXzwTgVTdEQVBNsvLyzACKdYMkL2sAwKLRPA0ii99/4YQAgJ2aSV1Rmop7AKhNAZNsUFuHRgCAOZ6Xn7VoVgdALcLmAEAts3cwXHxsjqBTTr0UJjyhXgNQns/y7hgAMRJSKwrSX9o+q2+lK+Ih/b41coZMAY0Uxh2jJh7aYLvtBbgCep6jxMcoPOd2mCP+tAC44k8JQCJ+OIBSI/J5NvFD9eU5a4FU/FAAWJ2PiGouflrEDwPALUIyICIQreKHAGgQnwcGCaJHvDkAjnFMQCgIzvjU2mFWCEmNk4KQjl8CYQKgxzgmiJIecspsv6gOIPb3sJNikXENIETjJxAWADDvNBmX7Ripo/fm88gRAJrF5yRjRHxsu8a9J9HWAFTEUyt5z+eWAA4v3qQOiN6YQrwVgGnEmwCwOsjomee176qvAQuA0VHWigAjAmsKrEtS65ZY97nA9pJ088bEaJoXh9W6ILEFMPNV2WIRVzsdlpz3j3ay9PfkAGI5OfN/BRKkaglP3tNp6OBIvWP5PHkfgQSQdW/gLdXBsRTDHVt0H4EFgPvLMz63AMzoNU2bVwRo0pxxrBUBM3pN0+YVAZo0Zxzr8hHwB9VpX1/uYOP2AAAAAElFTkSuQmCC\";\nvar IMG_BASE64_MID = \"data:image/image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAT1JREFUWEftlm0OwyAIhu3JNk+29WRsJ9tKowapH4AxXbI26T+Fx5dXcHEnfwvPDwBP59zNOXefwLZ67zF++jKAkPwxITENmUFwgE9YeSAdhSKHe/lNhhivCOC9P5RmFAD3A8B+QBpfDMC8YVLIDFDxhhpiBCB5I5QCjZrVUlKiEQAI13IlAFktewCwyRivttoDoyWgyUdNuEu/GfnNG0pNAZIc9+3NTa1AT15Jcrz7Zg9YAOjJY+MxAwAASoc/Oh+lbH6l5OZGxA3Ua9W15CYAZiCMwSdk1oxaydUADRlxnPKJGcsSy5SGDa2V2APhqvWCFUHopONG0QDgXlGr1RhUAyBK3rsNZgV+8j2gPW1pvbgEf61AmvvSaSctDR3prWlYutvSHNJ19Wd5aJezIIrviCnPb6kUuO4CuBT4AqsEKzBFERGIAAAAAElFTkSuQmCC\";\nvar IMG_BASE64_SMALL = \"data:image/image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAMdJREFUOE+lU4ENwjAM8z7hE8gl8AnwCVyS8QmngKOkCt0yFai0Ve0Sx7GzCb5U9QCAz9ASkQsDJ75UlYc9gMdQNnB+x4qIzBmAN4YabOLcg3pBi18AJDZsx6qsANwAPCsAJpIi92vPwtlpfKtaYCtzXz0l30sGocFGsoRbixZYlRr6bo4wKFU2TSoRdwCOIVwEub0fglYAzdusOquvtGN25xZoCy9OI4O0OQe/AoT334yyzYjNQfofRggwps1IAxjN7OP+BngBsiWUEe5m32cAAAAASUVORK5CYII=\";\nvar IMG_BG = \"#dddddd\";\nvar SKELETON_TEXT_CLASS = \"skeleton-text-block-mark\";\nvar IMG_CLASS_SMALL = \"sk-img-small\";\nvar IMG_CLASS_MID = \"sk-img-mid\";\nvar IMG_CLASS_LARGE = \"sk-img-large\";\nvar skeletonStyle = `\n\n      .${SKELETON_CLONE_CLASS}{\n        position:fixed;\n        left:0;\n        right:0;\n        top:0;\n        bottom:0;\n        z-index:1000000;\n        width:100vw;\n        height:100vh;\n      }\n\n      .${SKELETON_TEXT_CLASS},\n      .${SKELETON_TEXT_CLASS} * {\n        background-origin: content-box;\n        background-clip: content-box;\n        background-color: transparent;\n        color: transparent !important;\n        background-repeat: repeat-y;\n      }\n  \n      .${PSEUDO_CLASS}::before,\n      .${PSEUDO_CLASS}::after {\n        background: ${MAIN_COLOR} !important;\n        background-image: none !important;\n        color: transparent !important;\n        border-color: transparent !important;\n      }\n      .${PSEUDO_CLASS_ANIMATION}::before,\n      .${PSEUDO_CLASS_ANIMATION}::after {\n          animation: skeleton-opacity-animation 1.5s ease infinite !important;\n      }\n  \n      .${BUTTON_CLASS} {\n        box-shadow: none !important;\n      }\n\n      .${IMG_CLASS_SMALL}{\n         background-image: url(${IMG_BASE64_SMALL}) !important;\n         background-repeat:no-repeat !important;\n         background-position: center !important;\n      }\n      .${IMG_CLASS_MID}{\n         background-image: url(${IMG_BASE64_MID}) !important;\n         background-repeat:no-repeat !important;\n         background-position: center !important;\n      }\n      .${IMG_CLASS_LARGE}{\n         background-image: url(${IMG_BASE64_LARGE}) !important;\n         background-repeat:no-repeat !important;\n         background-position: center !important;\n      }\n  \n      .${TRANSPARENT_CLASS}::before,\n      .${TRANSPARENT_CLASS}::after {\n        opacity: 0 !important;\n      }\n      \n      @keyframes skeleton-opacity-animation {\n        0% {\n          opacity: 1;\n        }\n        30% {\n          opacity: 0.65;\n        }\n        100% {\n         opacity: 1;\n        }\n      }\n  \n    `;\nvar SkeletonRender = class {\n  constructor(options) {\n    this.options = Object.assign(\n      {\n        debug: false,\n        animation: true,\n        appId: \"app\",\n        minGrayBlockWidth: 30,\n        minGrayPseudoWidth: 30\n      },\n      options\n    );\n  }\n  removeMock() {\n    const getTextWidthElement = document.querySelector(`#${MOCK_WRAPPER_ID}`);\n    if (getTextWidthElement) getTextWidthElement.remove();\n  }\n  async genSkeleton() {\n    await this.startGenSkeleton();\n    this.removeMock();\n  }\n  async startGenSkeleton() {\n    const app = document.getElementById(this.options.appId);\n    if (!app) {\n      console.error(\"\\u6839\\u5143\\u7D20\\u6CA1\\u627E\\u5230~\");\n      return false;\n    }\n    const newNode = cloneElementWithUniqueIds(app);\n    newNode.id = \"__skeleton_clone\";\n    newNode.classList.add(SKELETON_CLONE_CLASS);\n    app.style.visibility = \"hidden\";\n    document.body.prepend(newNode);\n    this.styleHandler();\n    try {\n      this.handleNode(newNode);\n    } catch (e) {\n      if (e instanceof Error) {\n        console.log(\"==genSkeleton Error==\\n\", e.message, e.stack);\n      }\n    }\n  }\n  // Initialization processing DOM\n  styleHandler() {\n    const skeletonBlockStyleEle = document.createElement(\"style\");\n    skeletonBlockStyleEle.innerText = skeletonStyle.replace(/\\n/g, \"\");\n    document.body.prepend(skeletonBlockStyleEle);\n  }\n  // Processing a single node\n  handleNode(node) {\n    if (!node) return;\n    if (isTextNode(node)) {\n      const parent = node.parentNode;\n      if (!parent.classList.contains(SKELETON_TEXT_CLASS)) {\n        const textContent = node.textContent.replace(/[\\r\\n]/g, \"\").trim();\n        if (textContent) {\n          const tmpNode = document.createElement(\"i\");\n          tmpNode.classList.add(SKELETON_TEXT_CLASS);\n          tmpNode.innerHTML = textContent;\n          node.parentNode.replaceChild(tmpNode, node);\n          this.textHandler(tmpNode);\n          return true;\n        }\n      }\n    } else if (isHtmlElement(node)) {\n      if (!inViewPort(node) || hasAttr(node, \"data-skeleton-remove\")) {\n        return removeElement(node);\n      }\n      const ignore = hasAttr(node, \"data-skeleton-ignore\") || node.tagName === \"STYLE\";\n      if (ignore) return;\n      this.beforeHandler(node);\n      this.pseudoHandler(node);\n      const tagName = node.tagName && node.tagName.toUpperCase();\n      switch (tagName) {\n        case \"SCRIPT\":\n          this.scriptHandler(node);\n          break;\n        case \"IMG\":\n          this.imgHandler(node);\n          break;\n        case \"SVG\":\n          this.svgHandler(node);\n          break;\n        // 处理input 元素\n        // 删除placeholder 和 value\n        case \"INPUT\":\n          this.inputHandler(node);\n          break;\n        // 处理button\n        // 1. 设置boxshadow为none\n        // 2. 设置元素渲染出的宽高，清空子元素\n        case \"BUTTON\":\n          this.buttonHandler(node);\n          break;\n        // 处理A标签\n        // 1. 删除href属性\n        case \"A\":\n          this.aHandler(node);\n          break;\n      }\n      if (node.childNodes && node.childNodes.length === 1 && node.childNodes[0].nodeType === Node.TEXT_NODE) {\n        this.textHandler(node);\n        return;\n      }\n      if (node.hasChildNodes()) {\n        node.childNodes.forEach((node2) => this.handleNode(node2));\n      }\n    }\n  }\n  // 处理文本\n  // 1. 获取行高\n  // 2. 根据元素高度计算渲染几行\n  // 3. 利用background-repeat 和background-size y等于一行的高度 渲染出多行的骨架屏\n  // 4. 如果是多行，则处理最后一行的对齐方式，新增一个元素，利用定位覆盖\n  textHandler(ele) {\n    const comStyle = window.getComputedStyle(ele);\n    let {\n      display,\n      lineHeight,\n      paddingTop,\n      paddingRight,\n      paddingBottom,\n      paddingLeft,\n      position: pos,\n      fontSize,\n      textAlign,\n      wordSpacing,\n      wordBreak\n    } = comStyle;\n    if (!/\\d/.test(lineHeight)) {\n      const fontSizeNum = parseInt(fontSize, 10) || 14;\n      lineHeight = `${fontSizeNum * 1.4}px`;\n    }\n    const position = [\"fixed\", \"absolute\", \"flex\"].find((p) => p === pos) ? pos : \"relative\";\n    const height = ele.offsetHeight;\n    const width = ele.offsetWidth;\n    let lineCount = (height - parseFloat(paddingTop) - parseFloat(paddingBottom)) / parseFloat(lineHeight) || 0;\n    lineCount = lineCount < 1.5 ? 1 : lineCount;\n    const textHeightRatio = 0.6;\n    ele.classList.add(SKELETON_TEXT_CLASS);\n    Object.assign(ele.style, {\n      backgroundImage: `linear-gradient(\n            transparent ${(1 - textHeightRatio) / 2 * 100}%,\n            ${MAIN_COLOR} 0%,\n            ${MAIN_COLOR} ${((1 - textHeightRatio) / 2 + textHeightRatio) * 100}%,\n            transparent 0%\n          )`,\n      backgroundSize: `100% ${px2rem(parseInt(lineHeight) * 1.1)}`,\n      position\n    });\n    if (display === \"inline\") {\n      return;\n    }\n    if (lineCount > 1) {\n      this.addTextMask(\n        ele,\n        Object.assign(JSON.parse(JSON.stringify(comStyle)), {\n          lineHeight\n        })\n      );\n    } else {\n      const textWidth = this.getTextWidth(ele, {\n        fontSize,\n        lineHeight,\n        wordBreak,\n        wordSpacing\n      });\n      const textWidthPercent = textWidth / (width - parseInt(paddingRight, 10) - parseInt(paddingLeft, 10));\n      ele.style.backgroundSize = `${textWidthPercent * 100}% ${px2rem(parseInt(lineHeight) * 1.1)}`;\n      switch (textAlign) {\n        case \"left\":\n          break;\n        case \"right\":\n          ele.style.backgroundPositionX = \"100%\";\n          break;\n        case \"center\":\n          ele.style.backgroundPositionX = \"50%\";\n      }\n    }\n  }\n  addTextMask(paragraph, {\n    textAlign,\n    lineHeight,\n    paddingBottom,\n    paddingLeft,\n    paddingRight\n  }, maskWidthPercent = 0.5) {\n    let left;\n    let right;\n    switch (textAlign) {\n      case \"center\":\n        left = document.createElement(\"span\");\n        right = document.createElement(\"span\");\n        [left, right].forEach((mask) => {\n          Object.assign(mask.style, {\n            display: \"inline-block\",\n            width: `${maskWidthPercent / 2 * 100}%`,\n            height: lineHeight,\n            background: \"#fff\",\n            position: \"absolute\",\n            bottom: paddingBottom\n          });\n        });\n        left.style.left = paddingLeft;\n        right.style.right = paddingRight;\n        paragraph.appendChild(left);\n        paragraph.appendChild(right);\n        break;\n      case \"right\":\n        left = document.createElement(\"span\");\n        Object.assign(left.style, {\n          display: \"inline-block\",\n          width: `${maskWidthPercent * 100}%`,\n          height: lineHeight,\n          background: \"#fff\",\n          position: \"absolute\",\n          bottom: paddingBottom,\n          left: paddingLeft\n        });\n        paragraph.appendChild(left);\n        break;\n      case \"left\":\n      default:\n        right = document.createElement(\"span\");\n        Object.assign(right.style, {\n          display: \"inline-block\",\n          width: `${maskWidthPercent * 100}%`,\n          height: lineHeight,\n          background: \"#fff\",\n          position: \"absolute\",\n          bottom: paddingBottom,\n          right: paddingRight\n        });\n        paragraph.appendChild(right);\n        break;\n    }\n  }\n  getTextWidth(ele, style) {\n    const MOCK_TEXT_ID = \"skeleton-text-id\";\n    let offScreenParagraph = document.querySelector(`#${MOCK_TEXT_ID}`);\n    if (!offScreenParagraph) {\n      const wrapper = document.createElement(\"p\");\n      wrapper.id = MOCK_WRAPPER_ID;\n      offScreenParagraph = document.createElement(\"span\");\n      Object.assign(wrapper.style, {\n        width: \"10000px\",\n        position: \"absolute\",\n        top: \"0\"\n      });\n      offScreenParagraph.id = MOCK_TEXT_ID;\n      offScreenParagraph.style.visibility = \"hidden\";\n      wrapper.appendChild(offScreenParagraph);\n      document.body.appendChild(wrapper);\n    }\n    Object.assign(offScreenParagraph.style, style);\n    offScreenParagraph.innerHTML = ele.innerHTML;\n    return offScreenParagraph.getBoundingClientRect().width;\n  }\n  scriptHandler(node) {\n    removeElement(node);\n  }\n  imgHandler(node) {\n    if (node.src) {\n      if (/^data:image/.test(node.src)) {\n        return false;\n      } else if (node.src.indexOf(\n        \"https://zeekrlife-oss.oss-cn-hangzhou.aliyuncs.com/frontend\"\n      ) !== -1 || node.src.indexOf(\"https://zeekrlife-oss.zeekrlife.com/frontend\") !== -1) {\n        return false;\n      }\n    }\n    const { width, height } = node.getBoundingClientRect();\n    node.style.width = width + \"px\";\n    node.style.height = height + \"px\";\n    node.src = SMALLEST_BASE64;\n    node.style.backgroundColor = IMG_BG;\n    if (width >= 300 || height >= 300) {\n      node.classList.add(IMG_CLASS_LARGE);\n    } else if (width >= 150 || height >= 150) {\n      node.classList.add(IMG_CLASS_MID);\n    } else if (width >= 75 || height >= 75) {\n      node.classList.add(IMG_CLASS_SMALL);\n    }\n    this.addAnimationForElement(node);\n  }\n  aHandler(node) {\n    node.removeAttribute(\"href\");\n  }\n  svgHandler(node) {\n    const { width, height } = node.getBoundingClientRect();\n    if (width === 0 || height === 0 || node.getAttribute(\"aria-hidden\") === \"true\") {\n      return removeElement(node);\n    }\n    node.innerHTML = \"\";\n    Object.assign(node.style, {\n      width: px2rem(parseInt(width + \"\")),\n      height: px2rem(parseInt(height + \"\"))\n    });\n    this.addAnimationForElement(node);\n  }\n  inputHandler(node) {\n    node.removeAttribute(\"placeholder\");\n    node.value = \"\";\n  }\n  buttonHandler(node) {\n    if (!node.tagName) return;\n    node.classList.add(BUTTON_CLASS);\n    let { width, height } = window.getComputedStyle(node);\n    node.style.width = width;\n    node.style.height = height;\n    node.innerHTML = \"\";\n    this.addAnimationForElement(node);\n  }\n  /**\n   * Processing text nodes\n   * @param {*} node Node\n   * @return {Boolean} True means that processing has been completed, false means that processing still needs to be continued\n   */\n  pseudoHandler(node) {\n    if (!node.tagName) return;\n    const pseudo = checkHasPseudoEle(node);\n    if (!pseudo || !pseudo.ele) return;\n    const { ele, width } = pseudo;\n    if (width < this.options.minGrayPseudoWidth || 30) {\n      return ele.classList.add(TRANSPARENT_CLASS);\n    }\n    ele.classList.add(PSEUDO_CLASS);\n    if (this.options.animation) {\n      ele.classList.add(PSEUDO_CLASS_ANIMATION);\n    }\n  }\n  beforeHandler(node) {\n    if (!node.tagName) return;\n    if (hasAttr(node, \"data-skeleton-empty\")) {\n      emptyHandler(node);\n    }\n    const { width } = node.getBoundingClientRect();\n    const isHidden = width < this.options.minGrayBlockWidth;\n    if (isHidden) {\n      setOpacity(node);\n    }\n    const ComputedStyle = window.getComputedStyle(node);\n    if (ComputedStyle.backgroundImage !== \"none\") {\n      node.style.backgroundImage = \"none\";\n      node.style.background = MAIN_COLOR;\n      !isHidden && this.addAnimationForElement(node);\n    }\n    if (ComputedStyle.boxShadow !== \"none\") {\n      const oldBoxShadow = ComputedStyle.boxShadow;\n      const newBoxShadow = oldBoxShadow.replace(/^rgb.*\\)/, MAIN_COLOR_RGB);\n      node.style.boxShadow = newBoxShadow;\n    }\n    if (ComputedStyle.borderColor) {\n      node.style.borderColor = MAIN_COLOR;\n    }\n    const bgColor = node.getAttribute(\"data-skeleton-bgcolor\");\n    if (bgColor) {\n      node.style.backgroundColor = bgColor;\n      node.style.color = \"transparent\";\n      !isHidden && this.addAnimationForElement(node);\n    }\n  }\n  addAnimationForElement(ele) {\n    if (ele) {\n      ele.style.animation = this.options.animation ? \"skeleton-opacity-animation 1.5s ease infinite\" : \"\";\n    }\n  }\n};\nwindow.SkeletonRender = SkeletonRender;\n","import {\n  cloneElementWithUniqueIds,\n  removeElement,\n  px2rem,\n  sleep,\n  hasAttr,\n  inViewPort,\n  setOpacity,\n  emptyHandler,\n  checkHasPseudoEle,\n  isHtmlElement,\n  isTextNode\n} from \"./utils/skeletonUtil\";\nconst SKELETON_CLONE_CLASS = \"skeleton_clone\";\nconst MOCK_WRAPPER_ID = \"skeleton-text-wrapper-id\";\n// Skeleton main color\nconst MAIN_COLOR = \"#EEEEEE\";\nconst MAIN_COLOR_RGB = \"rgb(238, 238, 238)\";\n// Pseudo-class style\nconst PSEUDO_CLASS = \"sk-pseudo\";\nconst PSEUDO_CLASS_ANIMATION = \"sk-pseudo-animation\";\n// button style\nconst BUTTON_CLASS = \"sk-button\";\n// Transparent style\nconst TRANSPARENT_CLASS = \"sk-transparent\";\n// Transparent 1 pixel image\nconst SMALLEST_BASE64 =\n  \"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\";\nconst IMG_BASE64_LARGE =\n  \"data:image/image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAAopJREFUeF7tm1FyAyEIhs3JWk/W5mSmJ2tDRjtmBwUU3HXXPGUmG8P/gYJobu7ir9vF9TsWgBDCp3PuK8KC90d/3cFA7/03ZSgJIIQQnHMziMa03ikIVQBP7UAweZ6CedTPH/5JoWRcEcBJxCfdwOCBQZAAgAEgpNCBjuL+bL3Kp20xCmoAfjeiihSPIj7ZESHA2pVe/QC89+SCeSQQIYQ3B5bsZ0fAAiCIAKRuYOdlrSjaLQKIuoHMy1MDYKbOal6eFgBTPJmXzwTgVTdEQVBNsvLyzACKdYMkL2sAwKLRPA0ii99/4YQAgJ2aSV1Rmop7AKhNAZNsUFuHRgCAOZ6Xn7VoVgdALcLmAEAts3cwXHxsjqBTTr0UJjyhXgNQns/y7hgAMRJSKwrSX9o+q2+lK+Ih/b41coZMAY0Uxh2jJh7aYLvtBbgCep6jxMcoPOd2mCP+tAC44k8JQCJ+OIBSI/J5NvFD9eU5a4FU/FAAWJ2PiGouflrEDwPALUIyICIQreKHAGgQnwcGCaJHvDkAjnFMQCgIzvjU2mFWCEmNk4KQjl8CYQKgxzgmiJIecspsv6gOIPb3sJNikXENIETjJxAWADDvNBmX7Ripo/fm88gRAJrF5yRjRHxsu8a9J9HWAFTEUyt5z+eWAA4v3qQOiN6YQrwVgGnEmwCwOsjomee176qvAQuA0VHWigAjAmsKrEtS65ZY97nA9pJ088bEaJoXh9W6ILEFMPNV2WIRVzsdlpz3j3ay9PfkAGI5OfN/BRKkaglP3tNp6OBIvWP5PHkfgQSQdW/gLdXBsRTDHVt0H4EFgPvLMz63AMzoNU2bVwRo0pxxrBUBM3pN0+YVAZo0Zxzr8hHwB9VpX1/uYOP2AAAAAElFTkSuQmCC\";\nconst IMG_BASE64_MID =\n  \"data:image/image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAT1JREFUWEftlm0OwyAIhu3JNk+29WRsJ9tKowapH4AxXbI26T+Fx5dXcHEnfwvPDwBP59zNOXefwLZ67zF++jKAkPwxITENmUFwgE9YeSAdhSKHe/lNhhivCOC9P5RmFAD3A8B+QBpfDMC8YVLIDFDxhhpiBCB5I5QCjZrVUlKiEQAI13IlAFktewCwyRivttoDoyWgyUdNuEu/GfnNG0pNAZIc9+3NTa1AT15Jcrz7Zg9YAOjJY+MxAwAASoc/Oh+lbH6l5OZGxA3Ua9W15CYAZiCMwSdk1oxaydUADRlxnPKJGcsSy5SGDa2V2APhqvWCFUHopONG0QDgXlGr1RhUAyBK3rsNZgV+8j2gPW1pvbgEf61AmvvSaSctDR3prWlYutvSHNJ19Wd5aJezIIrviCnPb6kUuO4CuBT4AqsEKzBFERGIAAAAAElFTkSuQmCC\";\nconst IMG_BASE64_SMALL =\n  \"data:image/image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAMdJREFUOE+lU4ENwjAM8z7hE8gl8AnwCVyS8QmngKOkCt0yFai0Ve0Sx7GzCb5U9QCAz9ASkQsDJ75UlYc9gMdQNnB+x4qIzBmAN4YabOLcg3pBi18AJDZsx6qsANwAPCsAJpIi92vPwtlpfKtaYCtzXz0l30sGocFGsoRbixZYlRr6bo4wKFU2TSoRdwCOIVwEub0fglYAzdusOquvtGN25xZoCy9OI4O0OQe/AoT334yyzYjNQfofRggwps1IAxjN7OP+BngBsiWUEe5m32cAAAAASUVORK5CYII=\";\nconst IMG_BG = \"#dddddd\";\n// text class\nconst SKELETON_TEXT_CLASS = \"skeleton-text-block-mark\";\nconst IMG_CLASS_SMALL = \"sk-img-small\";\nconst IMG_CLASS_MID = \"sk-img-mid\";\nconst IMG_CLASS_LARGE = \"sk-img-large\";\n\nconst skeletonStyle = `\n\n      .${SKELETON_CLONE_CLASS}{\n        position:fixed;\n        left:0;\n        right:0;\n        top:0;\n        bottom:0;\n        z-index:1000000;\n        width:100vw;\n        height:100vh;\n      }\n\n      .${SKELETON_TEXT_CLASS},\n      .${SKELETON_TEXT_CLASS} * {\n        background-origin: content-box;\n        background-clip: content-box;\n        background-color: transparent;\n        color: transparent !important;\n        background-repeat: repeat-y;\n      }\n  \n      .${PSEUDO_CLASS}::before,\n      .${PSEUDO_CLASS}::after {\n        background: ${MAIN_COLOR} !important;\n        background-image: none !important;\n        color: transparent !important;\n        border-color: transparent !important;\n      }\n      .${PSEUDO_CLASS_ANIMATION}::before,\n      .${PSEUDO_CLASS_ANIMATION}::after {\n          animation: skeleton-opacity-animation 1.5s ease infinite !important;\n      }\n  \n      .${BUTTON_CLASS} {\n        box-shadow: none !important;\n      }\n\n      .${IMG_CLASS_SMALL}{\n         background-image: url(${IMG_BASE64_SMALL}) !important;\n         background-repeat:no-repeat !important;\n         background-position: center !important;\n      }\n      .${IMG_CLASS_MID}{\n         background-image: url(${IMG_BASE64_MID}) !important;\n         background-repeat:no-repeat !important;\n         background-position: center !important;\n      }\n      .${IMG_CLASS_LARGE}{\n         background-image: url(${IMG_BASE64_LARGE}) !important;\n         background-repeat:no-repeat !important;\n         background-position: center !important;\n      }\n  \n      .${TRANSPARENT_CLASS}::before,\n      .${TRANSPARENT_CLASS}::after {\n        opacity: 0 !important;\n      }\n      \n      @keyframes skeleton-opacity-animation {\n        0% {\n          opacity: 1;\n        }\n        30% {\n          opacity: 0.65;\n        }\n        100% {\n         opacity: 1;\n        }\n      }\n  \n    `;\n// List item Tag\nconst LIST_ITEM_TAG = [\"LI\", \"DT\", \"DD\"];\ntype SkeletonOption = PrerenderSkeletonOption[\"routes\"][number];\nexport default class SkeletonRender {\n  private options: Required<SkeletonOption>;\n  constructor(options: SkeletonOption) {\n    this.options = Object.assign(\n      {\n        debug: false,\n        animation: true,\n        appId: \"app\",\n        minGrayBlockWidth: 30,\n        minGrayPseudoWidth: 30,\n      },\n      options\n    );\n  }\n  removeMock() {\n    // 处理完成之后删除多余的10000px的 用来检测文本节点长度而生成的多余节点\n    const getTextWidthElement = document.querySelector(`#${MOCK_WRAPPER_ID}`);\n    if (getTextWidthElement) getTextWidthElement.remove();\n  }\n  async genSkeleton() {\n    await this.startGenSkeleton();\n    this.removeMock();\n  }\n  async startGenSkeleton() {\n    const app = document.getElementById(this.options.appId);\n    if (!app) {\n      console.error(\"根元素没找到~\");\n      return false;\n    }\n    const newNode = cloneElementWithUniqueIds(app);\n    newNode.id = \"__skeleton_clone\";\n    newNode.classList.add(SKELETON_CLONE_CLASS);\n    app.style.visibility = \"hidden\";\n    document.body.prepend(newNode);\n    // 初始化骨架屏样式\n    this.styleHandler();\n    try {\n      this.handleNode(newNode);\n    } catch (e) {\n      if (e instanceof Error) {\n        console.log(\"==genSkeleton Error==\\n\", e.message, e.stack);\n      }\n    }\n  }\n  // Initialization processing DOM\n  styleHandler() {\n    const skeletonBlockStyleEle = document.createElement(\"style\");\n    skeletonBlockStyleEle.innerText = skeletonStyle.replace(/\\n/g, \"\");\n    document.body.prepend(skeletonBlockStyleEle);\n  }\n  // Processing a single node\n  handleNode(node: HTMLElement | Node) {\n    if (!node) return;\n    // 如果是文本节点\n    if (isTextNode(node)) {\n      const parent = node.parentNode as HTMLElement;\n      // Determine if it has been processed\n      if (!parent.classList.contains(SKELETON_TEXT_CLASS)) {\n        // It is plain text itself and needs to be replaced with a node\n        const textContent = node.textContent!.replace(/[\\r\\n]/g, \"\").trim();\n        if (textContent) {\n          const tmpNode = document.createElement(\"i\");\n          tmpNode.classList.add(SKELETON_TEXT_CLASS);\n          tmpNode.innerHTML = textContent;\n          node.parentNode!.replaceChild(tmpNode, node);\n          this.textHandler(tmpNode);\n          return true;\n        }\n      }\n    }\n    // 是元素节点\n    else if (\n      isHtmlElement(node)\n    ) {\n      // Delete elements that are not in first screen, or marked for deletion\n      if (!inViewPort(node) || hasAttr(node, \"data-skeleton-remove\")) {\n        return removeElement(node);\n      }\n\n      // Handling elements that are ignored by user tags -> End\n      const ignore =\n        hasAttr(node, \"data-skeleton-ignore\") || node.tagName === \"STYLE\";\n      if (ignore) return;\n\n      // 处理默认样式\n      // 1. 有data-skeleton-empty属性的清空子元素，和伪类元素的背景色\n      // 2 如果元素宽度小于最小宽度，则透明度设置为0\n      // 3 如果有backgroundImage背景图片的话，则把背景图设置为none，设置默认背景色 ,如果配置options有动画属性，则给元素添加动画\n      // 4 如果有阴影的话，替换为默认阴影\n      // 5 如果有边框的话，替换为默认边框\n      // 6 如果有自定义data-skeleton-bgcolor背景色的话，则设置自定义背景色，并把颜色color设置为透明，如果配置options有动画属性，则给元素添加动画\n      this.beforeHandler(node);\n      // 处理伪元素\n      // 如果伪元素宽度小于最小宽度，则透明度设置为0，否则的话设置为默认背景色、背景图片为none、默认边框颜色、把颜色color设置为透明,如果配置options有动画属性，则给元素添加动画\n      this.pseudoHandler(node);\n\n      const tagName = node.tagName && node.tagName.toUpperCase();\n      switch (tagName) {\n        case \"SCRIPT\":\n          // 如果是script标签的话，则删除元素\n          this.scriptHandler(node);\n          break;\n        case \"IMG\":\n          // img元素处理\n          // 1. 如果是base64或则静态图 不处理直接返回\n          // 2. 这是渲染出来的固定宽高，设置src为空的base64\n          // 3. 设置图片默认的背景色和backgroundImage背景图片\n          this.imgHandler(node as HTMLImageElement);\n          break;\n        case \"SVG\":\n          // svg处理\n          // 1. 如果aria-hidden属性为true，或则宽高为0，则删除元素\n          // 2. 清除元素centent\n          // 3. 设置元素渲染后的宽高\n          this.svgHandler(node as HTMLImageElement);\n          break;\n        // 处理input 元素\n        // 删除placeholder 和 value\n        case \"INPUT\":\n          this.inputHandler(node as HTMLInputElement);\n          break;\n        // 处理button\n        // 1. 设置boxshadow为none\n        // 2. 设置元素渲染出的宽高，清空子元素\n        case \"BUTTON\": // Button processing ends once\n          this.buttonHandler(node as HTMLButtonElement);\n          break;\n          // 处理A标签\n          // 1. 删除href属性\n        case \"A\": // A label processing is placed behind to prevent IMG from displaying an exception\n          this.aHandler(node);\n          break;\n      }\n      // 处理子节点为纯文本节点元素 <p>xxx</p>\n      if (\n        node.childNodes &&\n        node.childNodes.length === 1 &&\n        node.childNodes[0].nodeType === Node.TEXT_NODE\n      ) {\n        this.textHandler(node);\n        return;\n      }\n      if (node.hasChildNodes()) {\n        node.childNodes.forEach((node) => this.handleNode(node));\n      }\n    }\n  }\n  // 处理文本\n  // 1. 获取行高\n  // 2. 根据元素高度计算渲染几行\n  // 3. 利用background-repeat 和background-size y等于一行的高度 渲染出多行的骨架屏\n  // 4. 如果是多行，则处理最后一行的对齐方式，新增一个元素，利用定位覆盖\n  textHandler(ele: HTMLElement) {\n    // Handling text styles\n    const comStyle = window.getComputedStyle(ele);\n    let {\n      display,\n      lineHeight,\n      paddingTop,\n      paddingRight,\n      paddingBottom,\n      paddingLeft,\n      position: pos,\n      fontSize,\n      textAlign,\n      wordSpacing,\n      wordBreak,\n    } = comStyle;\n    if (!/\\d/.test(lineHeight)) {\n      const fontSizeNum = parseInt(fontSize, 10) || 14;\n      lineHeight = `${fontSizeNum * 1.4}px`;\n    }\n    const position = [\"fixed\", \"absolute\", \"flex\"].find((p) => p === pos)\n      ? pos\n      : \"relative\";\n\n    const height = ele.offsetHeight;\n    const width = ele.offsetWidth;\n    // Round down\n    let lineCount =\n      (height - parseFloat(paddingTop) - parseFloat(paddingBottom)) /\n        parseFloat(lineHeight) || 0;\n\n    lineCount = lineCount < 1.5 ? 1 : lineCount;\n\n    const textHeightRatio = 0.6; // Default\n\n    // Add text block class name tag\n    ele.classList.add(SKELETON_TEXT_CLASS);\n\n    Object.assign(ele.style, {\n      backgroundImage: `linear-gradient(\n            transparent ${((1 - textHeightRatio) / 2) * 100}%,\n            ${MAIN_COLOR} 0%,\n            ${MAIN_COLOR} ${\n        ((1 - textHeightRatio) / 2 + textHeightRatio) * 100\n      }%,\n            transparent 0%\n          )`,\n      backgroundSize: `100% ${px2rem(parseInt(lineHeight) * 1.1)}`,\n      position,\n    });\n    // add white mask\n    if(display==='inline'){\n      return\n    }\n    if (lineCount > 1) {\n      this.addTextMask(\n        ele,\n        Object.assign(JSON.parse(JSON.stringify(comStyle)), {\n          lineHeight,\n        })\n      );\n    } else {\n      const textWidth = this.getTextWidth(ele, {\n        fontSize,\n        lineHeight,\n        wordBreak,\n        wordSpacing,\n      });\n      const textWidthPercent =\n        textWidth /\n        (width -\n          parseInt(paddingRight, 10) -\n          parseInt(paddingLeft, 10));\n      ele.style.backgroundSize = `${textWidthPercent * 100}% ${px2rem(parseInt(lineHeight) * 1.1)}`;\n      switch (textAlign) {\n        case \"left\":\n          break;\n        case \"right\":\n          ele.style.backgroundPositionX = \"100%\";\n          break;\n        case \"center\":\n          ele.style.backgroundPositionX = \"50%\";\n      }\n    }\n  }\n  addTextMask(\n    paragraph: HTMLElement,\n    {\n      textAlign,\n      lineHeight,\n      paddingBottom,\n      paddingLeft,\n      paddingRight,\n    }: {\n      textAlign: string;\n      lineHeight: string;\n      paddingBottom: string;\n      paddingLeft: string;\n      paddingRight: string;\n    },\n    maskWidthPercent = 0.5\n  ) {\n    let left;\n    let right;\n    switch (textAlign) {\n      case \"center\":\n        left = document.createElement(\"span\");\n        right = document.createElement(\"span\");\n        [left, right].forEach((mask) => {\n          Object.assign(mask.style, {\n            display: \"inline-block\",\n            width: `${(maskWidthPercent / 2) * 100}%`,\n            height: lineHeight,\n            background: \"#fff\",\n            position: \"absolute\",\n            bottom: paddingBottom,\n          });\n        });\n        left.style.left = paddingLeft;\n        right.style.right = paddingRight;\n        paragraph.appendChild(left);\n        paragraph.appendChild(right);\n        break;\n      case \"right\":\n        left = document.createElement(\"span\");\n        Object.assign(left.style, {\n          display: \"inline-block\",\n          width: `${maskWidthPercent * 100}%`,\n          height: lineHeight,\n          background: \"#fff\",\n          position: \"absolute\",\n          bottom: paddingBottom,\n          left: paddingLeft,\n        });\n        paragraph.appendChild(left);\n        break;\n      case \"left\":\n      default:\n        right = document.createElement(\"span\");\n        Object.assign(right.style, {\n          display: \"inline-block\",\n          width: `${maskWidthPercent * 100}%`,\n          height: lineHeight,\n          background: \"#fff\",\n          position: \"absolute\",\n          bottom: paddingBottom,\n          right: paddingRight,\n        });\n        paragraph.appendChild(right);\n        break;\n    }\n  }\n\n  getTextWidth(\n    ele: HTMLElement,\n    style: {\n      fontSize: string;\n      lineHeight: string;\n      wordBreak: string;\n      wordSpacing: string;\n    }\n  ) {\n    const MOCK_TEXT_ID = \"skeleton-text-id\";\n    let offScreenParagraph = document.querySelector(`#${MOCK_TEXT_ID}`);\n    if (!offScreenParagraph) {\n      const wrapper = document.createElement(\"p\");\n      wrapper.id = MOCK_WRAPPER_ID;\n      offScreenParagraph = document.createElement(\"span\");\n      Object.assign(wrapper.style, {\n        width: \"10000px\",\n        position: \"absolute\",\n        top: \"0\",\n      });\n      offScreenParagraph.id = MOCK_TEXT_ID;\n      (offScreenParagraph as HTMLElement).style.visibility = \"hidden\";\n      wrapper.appendChild(offScreenParagraph);\n      document.body.appendChild(wrapper);\n    }\n    Object.assign((offScreenParagraph as HTMLElement).style, style);\n    // ele.childNodes && setStylesInNode(ele.childNodes);\n    offScreenParagraph.innerHTML = ele.innerHTML;\n    return offScreenParagraph.getBoundingClientRect().width;\n  }\n\n  scriptHandler(node: HTMLElement) {\n    removeElement(node);\n  }\n  imgHandler(node: HTMLImageElement) {\n    if (node.src) {\n      // 如果是base64，不处理\n      if (/^data:image/.test(node.src)) {\n        return false;\n      }\n      // 如果是oss静态图也不处理\n      else if (\n        node.src.indexOf(\n          \"https://zeekrlife-oss.oss-cn-hangzhou.aliyuncs.com/frontend\"\n        ) !== -1 ||\n        node.src.indexOf(\"https://zeekrlife-oss.zeekrlife.com/frontend\") !== -1\n      ) {\n        return false;\n      }\n    }\n    const { width, height } = node.getBoundingClientRect();\n    node.style.width = width + \"px\";\n    node.style.height = height + \"px\";\n    node.src = SMALLEST_BASE64;\n    node.style.backgroundColor = IMG_BG;\n    if (width >= 300 || height >= 300) {\n      node.classList.add(IMG_CLASS_LARGE);\n    } else if (width >= 150 || height >= 150) {\n      node.classList.add(IMG_CLASS_MID);\n    } else if (width >= 75 || height >= 75) {\n      node.classList.add(IMG_CLASS_SMALL);\n    }\n    this.addAnimationForElement(node);\n  }\n  aHandler(node: HTMLElement) {\n    node.removeAttribute(\"href\");\n  }\n  svgHandler(node: HTMLImageElement) {\n    const { width, height } = node.getBoundingClientRect();\n    // Remove elements if they are not visible\n    if (\n      width === 0 ||\n      height === 0 ||\n      node.getAttribute(\"aria-hidden\") === \"true\"\n    ) {\n      return removeElement(node);\n    }\n\n    // Clear node centent\n    node.innerHTML = \"\";\n\n    // Set style\n    Object.assign(node.style, {\n      width: px2rem(parseInt(width + \"\")),\n      height: px2rem(parseInt(height + \"\")),\n    });\n    this.addAnimationForElement(node);\n  }\n  inputHandler(node: HTMLInputElement) {\n    node.removeAttribute(\"placeholder\");\n    node.value = \"\";\n  }\n  buttonHandler(node: HTMLButtonElement) {\n    if (!node.tagName) return;\n\n    node.classList.add(BUTTON_CLASS);\n\n    let { width, height } = window.getComputedStyle(node);\n\n    node.style.width = width;\n    node.style.height = height;\n\n    // Clear button content\n    node.innerHTML = \"\";\n    this.addAnimationForElement(node);\n  }\n  /**\n   * Processing text nodes\n   * @param {*} node Node\n   * @return {Boolean} True means that processing has been completed, false means that processing still needs to be continued\n   */\n\n  pseudoHandler(node: HTMLElement) {\n    if (!node.tagName) return;\n\n    const pseudo = checkHasPseudoEle(node);\n\n    if (!pseudo || !pseudo.ele) return;\n\n    const { ele, width } = pseudo;\n\n    // Width is less than the hiding threshold\n    if (width < this.options.minGrayPseudoWidth || 30) {\n      return ele.classList.add(TRANSPARENT_CLASS);\n    }\n\n    ele.classList.add(PSEUDO_CLASS);\n    if (this.options.animation) {\n      ele.classList.add(PSEUDO_CLASS_ANIMATION);\n    }\n  }\n  beforeHandler(node: HTMLElement) {\n    if (!node.tagName) return;\n    // Handling empty elements of user tags\n    if (hasAttr(node, \"data-skeleton-empty\")) {\n      emptyHandler(node);\n    }\n\n    // Width is less than the hiding threshold\n    const { width } = node.getBoundingClientRect();\n    const isHidden = width < this.options.minGrayBlockWidth;\n    if (isHidden) {\n      setOpacity(node);\n    }\n\n    const ComputedStyle = window.getComputedStyle(node);\n\n    // The background image is changed to the main color\n    if (ComputedStyle.backgroundImage !== \"none\") {\n      node.style.backgroundImage = \"none\";\n      node.style.background = MAIN_COLOR;\n      // 增加动画效果\n      !isHidden && this.addAnimationForElement(node);\n    }\n\n    // The Shadow is changed to the main color\n    if (ComputedStyle.boxShadow !== \"none\") {\n      const oldBoxShadow = ComputedStyle.boxShadow;\n      const newBoxShadow = oldBoxShadow.replace(/^rgb.*\\)/, MAIN_COLOR_RGB);\n      node.style.boxShadow = newBoxShadow;\n    }\n\n    // The border is changed to the main color\n    if (ComputedStyle.borderColor) {\n      node.style.borderColor = MAIN_COLOR;\n    }\n\n    // Set the background color of the user class\n    const bgColor = node.getAttribute(\"data-skeleton-bgcolor\");\n    if (bgColor) {\n      node.style.backgroundColor = bgColor;\n      node.style.color = \"transparent\";\n      // 增加动画效果\n      !isHidden && this.addAnimationForElement(node);\n    }\n  }\n  addAnimationForElement(ele: HTMLElement) {\n    if (ele) {\n      ele.style.animation = this.options.animation\n        ? \"skeleton-opacity-animation 1.5s ease infinite\"\n        : \"\";\n    }\n  }\n}\nwindow.SkeletonRender = SkeletonRender;\n","export const cloneElementWithUniqueIds = (\n  element: HTMLElement,\n  prefix = \"__clone\"\n) => {\n  // 深度克隆元素\n  const clonedElement = element.cloneNode(true) as HTMLElement;\n  // 递归更新克隆元素及其子元素的 i\n  function updateIds(el: HTMLElement, parentPrefix: string) {\n    if (el.id) {\n      el.id = `${parentPrefix}-${el.id}`; // 为现有 id 添加前缀\n    }\n    Array.from(el.children).forEach((child, index) => {\n      updateIds(child as HTMLElement, `${parentPrefix}-${index}`); // 子元素的前缀基于父元素\n    });\n  }\n  updateIds(clonedElement, prefix); // 开始更新 id\n  return clonedElement;\n};\n// Delete element\nexport const removeElement = (ele: HTMLElement) => {\n  const parent = ele.parentNode;\n  if (parent) {\n    parent.removeChild(ele);\n  }\n};\n\n// sleep function\nexport const sleep = (ms: number) => {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n};\n\n// Check if the node is in the first screen\nexport const inViewPort = (ele: HTMLElement) => {\n  try {\n    const rect = ele.getBoundingClientRect();\n    return rect.top < window.innerHeight && rect.left < window.innerWidth;\n  } catch (e) {\n    return true;\n  }\n};\n\n// Determine if the node has attributes\nexport const hasAttr = (ele: HTMLElement, attr: string) => {\n  try {\n    return ele.hasAttribute(attr);\n  } catch (e) {\n    return false;\n  }\n};\n\n// Set node transparency\nexport const setOpacity = (ele: HTMLElement) => {\n  if (ele.style) {\n    // @ts-ignore\n    ele.style.opacity = 0;\n  }\n};\n\n// Unit conversion px -> rem\nexport const px2rem = (px: number | string) => {\n  const pxValue = typeof px === \"string\" ? parseInt(px, 10) : px;\n  const htmlElementFontSize = window.getComputedStyle(\n    document.documentElement\n  ).fontSize;\n\n  return `${pxValue / parseInt(htmlElementFontSize, 10)}rem`;\n};\n\nexport const emptyHandler = (node: HTMLElement) => {\n  node.innerHTML = \"\";\n  let classNameArr = (node.className && node.className.split(\" \")) || [];\n  classNameArr = classNameArr.map((item) => {\n    return \".\" + item;\n  });\n  const className = classNameArr.join(\"\");\n  const id = node.id ? \"#\" + node.id : \"\";\n  const query = className || id;\n\n  if (!query) return;\n\n  let styleSheet;\n\n  for (const item of document.styleSheets) {\n    if (!item.href) {\n      styleSheet = item;\n      break;\n    }\n  }\n\n  try {\n    styleSheet &&\n      styleSheet.insertRule(\n        `${query}::before{content:'' !important;background:none !important;}`,\n        0\n      );\n    styleSheet &&\n      styleSheet.insertRule(\n        `${query}::after{content:'' !important;background:none !important;}`,\n        0\n      );\n  } catch (e) {\n    console.log(\"handleEmptyNode Error: \", JSON.stringify(e));\n  }\n};\n\n// Check the element pseudo-class to return the corresponding element and width\nexport const checkHasPseudoEle = (ele: HTMLElement) => {\n  if (!ele) return false;\n\n  const beforeComputedStyle = window.getComputedStyle(ele, \"::before\");\n  const beforeContent = beforeComputedStyle.getPropertyValue(\"content\");\n  const beforeWidth =\n    parseFloat(beforeComputedStyle.getPropertyValue(\"width\")) || 0;\n  const hasBefore = beforeContent && beforeContent !== \"none\";\n\n  const afterComputedStyle = window.getComputedStyle(ele, \"::after\");\n  const afterContent = afterComputedStyle.getPropertyValue(\"content\");\n  const afterWidth =\n    parseFloat(afterComputedStyle.getPropertyValue(\"width\")) || 0;\n  const hasAfter = afterContent && afterContent !== \"none\";\n\n  const width = Math.max(beforeWidth, afterWidth);\n\n  if (hasBefore || hasAfter) {\n    return { hasBefore, hasAfter, ele, width };\n  }\n  return false;\n};\nexport const isTextNode = (node:  HTMLElement | Node): node is Text => {\n  return node.nodeType === Node.TEXT_NODE && node.nodeValue !== \"\";\n};\nexport const isHtmlElement = (\n  node: HTMLElement | Node\n): node is HTMLElement => {\n  return node.nodeType === Node.ELEMENT_NODE;\n};\n"]}