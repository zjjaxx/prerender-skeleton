{"version":3,"sources":["/Users/zhengjiajun/zjj/learn/prerender-skeleton/packages/skeleton/dist/skeleton.global.js","../src/utils/skeletonUtil.ts","../src/skeleton.ts"],"names":["cloneElementWithUniqueIds","element","prefix","clonedElement","cloneNode","updateIds","el","parentPrefix","id","Array","from","children","forEach","child","index","removeElement","ele","parent","parentNode","removeChild","inViewPort","rect","getBoundingClientRect","top","window","innerHeight","left","innerWidth","e","hasAttr","attr","hasAttribute","setOpacity","style","opacity","px2rem","px","pxValue","parseInt","htmlElementFontSize","getComputedStyle","document","documentElement","fontSize","emptyHandler","node","innerHTML","classNameArr","className","split","map","item","join","query","styleSheet","styleSheets","href","insertRule","console","log","JSON","stringify","checkHasPseudoEle","beforeComputedStyle","beforeContent","getPropertyValue","beforeWidth","parseFloat","hasBefore","afterComputedStyle","afterContent","afterWidth","hasAfter","width","Math","max","isTextNode","nodeType","Node","TEXT_NODE","nodeValue","isHtmlElement","ELEMENT_NODE","SKELETON_CLONE_CLASS","MOCK_WRAPPER_ID","MAIN_COLOR","MAIN_COLOR_RGB","PSEUDO_CLASS","PSEUDO_CLASS_ANIMATION","BUTTON_CLASS","TRANSPARENT_CLASS","SMALLEST_BASE64","IMG_BASE64_LARGE","IMG_BASE64_MID","IMG_BASE64_SMALL","IMG_BG","SKELETON_TEXT_CLASS","IMG_CLASS_SMALL","IMG_CLASS_MID","IMG_CLASS_LARGE","skeletonStyle","SkeletonRender","options","Object","assign","animation","appId","minGrayBlockWidth","minGrayPseudoWidth","removeMock","getTextWidthElement","querySelector","remove","genSkeleton","startGenSkeleton","app","newNode","getElementById","error","classList","add","visibility","body","prepend","styleHandler","handleNode","Error","message","stack","skeletonBlockStyleEle","createElement","innerText","replace","contains","textContent","trim","tmpNode","replaceChild","textHandler","ignore","tagName","beforeHandler","pseudoHandler","toUpperCase","scriptHandler","imgHandler","svgHandler","inputHandler","buttonHandler","aHandler","childNodes","length","hasChildNodes","comStyle","display","lineHeight","paddingTop","paddingRight","paddingBottom","paddingLeft","position","pos","textAlign","wordSpacing","wordBreak","test","fontSizeNum","find","p","height","offsetHeight","offsetWidth","lineCount","textHeightRatio","backgroundImage","backgroundSize","addAnimationForElement","addTextMask","parse","textWidth","getTextWidth","textWidthPercent","backgroundPositionX","paragraph","maskWidthPercent","right","mask","background","bottom","appendChild","MOCK_TEXT_ID","offScreenParagraph","wrapper","src","indexOf","backgroundColor","removeAttribute","getAttribute","value","pseudo","isHidden","ComputedStyle","boxShadow","oldBoxShadow","newBoxShadow","borderColor","bgColor","color"],"mappings":"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","sourcesContent":["\"use strict\";\n(() => {\n  // src/utils/skeletonUtil.ts\n  var cloneElementWithUniqueIds = (element, prefix = \"__clone\") => {\n    const clonedElement = element.cloneNode(true);\n    function updateIds(el, parentPrefix) {\n      if (el.id) {\n        el.id = `${parentPrefix}-${el.id}`;\n      }\n      Array.from(el.children).forEach((child, index) => {\n        updateIds(child, `${parentPrefix}-${index}`);\n      });\n    }\n    updateIds(clonedElement, prefix);\n    return clonedElement;\n  };\n  var removeElement = (ele) => {\n    const parent = ele.parentNode;\n    if (parent) {\n      parent.removeChild(ele);\n    }\n  };\n  var inViewPort = (ele) => {\n    try {\n      const rect = ele.getBoundingClientRect();\n      return rect.top < window.innerHeight && rect.left < window.innerWidth;\n    } catch (e) {\n      return true;\n    }\n  };\n  var hasAttr = (ele, attr) => {\n    try {\n      return ele.hasAttribute(attr);\n    } catch (e) {\n      return false;\n    }\n  };\n  var setOpacity = (ele) => {\n    if (ele.style) {\n      ele.style.opacity = 0;\n    }\n  };\n  var px2rem = (px) => {\n    const pxValue = typeof px === \"string\" ? parseInt(px, 10) : px;\n    const htmlElementFontSize = window.getComputedStyle(\n      document.documentElement\n    ).fontSize;\n    return `${pxValue / parseInt(htmlElementFontSize, 10)}rem`;\n  };\n  var emptyHandler = (node) => {\n    node.innerHTML = \"\";\n    let classNameArr = node.className && node.className.split(\" \") || [];\n    classNameArr = classNameArr.map((item) => {\n      return \".\" + item;\n    });\n    const className = classNameArr.join(\"\");\n    const id = node.id ? \"#\" + node.id : \"\";\n    const query = className || id;\n    if (!query) return;\n    let styleSheet;\n    for (const item of document.styleSheets) {\n      if (!item.href) {\n        styleSheet = item;\n        break;\n      }\n    }\n    try {\n      styleSheet && styleSheet.insertRule(\n        `${query}::before{content:'' !important;background:none !important;}`,\n        0\n      );\n      styleSheet && styleSheet.insertRule(\n        `${query}::after{content:'' !important;background:none !important;}`,\n        0\n      );\n    } catch (e) {\n      console.log(\"handleEmptyNode Error: \", JSON.stringify(e));\n    }\n  };\n  var checkHasPseudoEle = (ele) => {\n    if (!ele) return false;\n    const beforeComputedStyle = window.getComputedStyle(ele, \"::before\");\n    const beforeContent = beforeComputedStyle.getPropertyValue(\"content\");\n    const beforeWidth = parseFloat(beforeComputedStyle.getPropertyValue(\"width\")) || 0;\n    const hasBefore = beforeContent && beforeContent !== \"none\";\n    const afterComputedStyle = window.getComputedStyle(ele, \"::after\");\n    const afterContent = afterComputedStyle.getPropertyValue(\"content\");\n    const afterWidth = parseFloat(afterComputedStyle.getPropertyValue(\"width\")) || 0;\n    const hasAfter = afterContent && afterContent !== \"none\";\n    const width = Math.max(beforeWidth, afterWidth);\n    if (hasBefore || hasAfter) {\n      return { hasBefore, hasAfter, ele, width };\n    }\n    return false;\n  };\n  var isTextNode = (node) => {\n    return node.nodeType === Node.TEXT_NODE && node.nodeValue !== \"\";\n  };\n  var isHtmlElement = (node) => {\n    return node.nodeType === Node.ELEMENT_NODE;\n  };\n\n  // src/skeleton.ts\n  var SKELETON_CLONE_CLASS = \"skeleton_clone\";\n  var MOCK_WRAPPER_ID = \"skeleton-text-wrapper-id\";\n  var MAIN_COLOR = \"#EEEEEE\";\n  var MAIN_COLOR_RGB = \"rgb(238, 238, 238)\";\n  var PSEUDO_CLASS = \"sk-pseudo\";\n  var PSEUDO_CLASS_ANIMATION = \"sk-pseudo-animation\";\n  var BUTTON_CLASS = \"sk-button\";\n  var TRANSPARENT_CLASS = \"sk-transparent\";\n  var SMALLEST_BASE64 = \"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\";\n  var IMG_BASE64_LARGE = \"data:image/image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAAopJREFUeF7tm1FyAyEIhs3JWk/W5mSmJ2tDRjtmBwUU3HXXPGUmG8P/gYJobu7ir9vF9TsWgBDCp3PuK8KC90d/3cFA7/03ZSgJIIQQnHMziMa03ikIVQBP7UAweZ6CedTPH/5JoWRcEcBJxCfdwOCBQZAAgAEgpNCBjuL+bL3Kp20xCmoAfjeiihSPIj7ZESHA2pVe/QC89+SCeSQQIYQ3B5bsZ0fAAiCIAKRuYOdlrSjaLQKIuoHMy1MDYKbOal6eFgBTPJmXzwTgVTdEQVBNsvLyzACKdYMkL2sAwKLRPA0ii99/4YQAgJ2aSV1Rmop7AKhNAZNsUFuHRgCAOZ6Xn7VoVgdALcLmAEAts3cwXHxsjqBTTr0UJjyhXgNQns/y7hgAMRJSKwrSX9o+q2+lK+Ih/b41coZMAY0Uxh2jJh7aYLvtBbgCep6jxMcoPOd2mCP+tAC44k8JQCJ+OIBSI/J5NvFD9eU5a4FU/FAAWJ2PiGouflrEDwPALUIyICIQreKHAGgQnwcGCaJHvDkAjnFMQCgIzvjU2mFWCEmNk4KQjl8CYQKgxzgmiJIecspsv6gOIPb3sJNikXENIETjJxAWADDvNBmX7Ripo/fm88gRAJrF5yRjRHxsu8a9J9HWAFTEUyt5z+eWAA4v3qQOiN6YQrwVgGnEmwCwOsjomee176qvAQuA0VHWigAjAmsKrEtS65ZY97nA9pJ088bEaJoXh9W6ILEFMPNV2WIRVzsdlpz3j3ay9PfkAGI5OfN/BRKkaglP3tNp6OBIvWP5PHkfgQSQdW/gLdXBsRTDHVt0H4EFgPvLMz63AMzoNU2bVwRo0pxxrBUBM3pN0+YVAZo0Zxzr8hHwB9VpX1/uYOP2AAAAAElFTkSuQmCC\";\n  var IMG_BASE64_MID = \"data:image/image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAT1JREFUWEftlm0OwyAIhu3JNk+29WRsJ9tKowapH4AxXbI26T+Fx5dXcHEnfwvPDwBP59zNOXefwLZ67zF++jKAkPwxITENmUFwgE9YeSAdhSKHe/lNhhivCOC9P5RmFAD3A8B+QBpfDMC8YVLIDFDxhhpiBCB5I5QCjZrVUlKiEQAI13IlAFktewCwyRivttoDoyWgyUdNuEu/GfnNG0pNAZIc9+3NTa1AT15Jcrz7Zg9YAOjJY+MxAwAASoc/Oh+lbH6l5OZGxA3Ua9W15CYAZiCMwSdk1oxaydUADRlxnPKJGcsSy5SGDa2V2APhqvWCFUHopONG0QDgXlGr1RhUAyBK3rsNZgV+8j2gPW1pvbgEf61AmvvSaSctDR3prWlYutvSHNJ19Wd5aJezIIrviCnPb6kUuO4CuBT4AqsEKzBFERGIAAAAAElFTkSuQmCC\";\n  var IMG_BASE64_SMALL = \"data:image/image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAMdJREFUOE+lU4ENwjAM8z7hE8gl8AnwCVyS8QmngKOkCt0yFai0Ve0Sx7GzCb5U9QCAz9ASkQsDJ75UlYc9gMdQNnB+x4qIzBmAN4YabOLcg3pBi18AJDZsx6qsANwAPCsAJpIi92vPwtlpfKtaYCtzXz0l30sGocFGsoRbixZYlRr6bo4wKFU2TSoRdwCOIVwEub0fglYAzdusOquvtGN25xZoCy9OI4O0OQe/AoT334yyzYjNQfofRggwps1IAxjN7OP+BngBsiWUEe5m32cAAAAASUVORK5CYII=\";\n  var IMG_BG = \"#dddddd\";\n  var SKELETON_TEXT_CLASS = \"skeleton-text-block-mark\";\n  var IMG_CLASS_SMALL = \"sk-img-small\";\n  var IMG_CLASS_MID = \"sk-img-mid\";\n  var IMG_CLASS_LARGE = \"sk-img-large\";\n  var skeletonStyle = `\n\n      .${SKELETON_CLONE_CLASS}{\n        position:fixed;\n        left:0;\n        right:0;\n        top:0;\n        bottom:0;\n        z-index:1000000;\n        width:100vw;\n        height:100vh;\n      }\n\n      .${SKELETON_TEXT_CLASS},\n      .${SKELETON_TEXT_CLASS} * {\n        background-origin: content-box;\n        background-clip: content-box;\n        background-color: transparent;\n        color: transparent !important;\n        background-repeat: repeat-y;\n      }\n  \n      .${PSEUDO_CLASS}::before,\n      .${PSEUDO_CLASS}::after {\n        background: ${MAIN_COLOR} !important;\n        background-image: none !important;\n        color: transparent !important;\n        border-color: transparent !important;\n      }\n      .${PSEUDO_CLASS_ANIMATION}::before,\n      .${PSEUDO_CLASS_ANIMATION}::after {\n          animation: skeleton-opacity-animation 1.5s ease infinite !important;\n      }\n  \n      .${BUTTON_CLASS} {\n        box-shadow: none !important;\n      }\n\n      .${IMG_CLASS_SMALL}{\n         background-image: url(${IMG_BASE64_SMALL}) !important;\n         background-repeat:no-repeat !important;\n         background-position: center !important;\n      }\n      .${IMG_CLASS_MID}{\n         background-image: url(${IMG_BASE64_MID}) !important;\n         background-repeat:no-repeat !important;\n         background-position: center !important;\n      }\n      .${IMG_CLASS_LARGE}{\n         background-image: url(${IMG_BASE64_LARGE}) !important;\n         background-repeat:no-repeat !important;\n         background-position: center !important;\n      }\n  \n      .${TRANSPARENT_CLASS}::before,\n      .${TRANSPARENT_CLASS}::after {\n        opacity: 0 !important;\n      }\n      \n      @keyframes skeleton-opacity-animation {\n        0% {\n          opacity: 1;\n        }\n        30% {\n          opacity: 0.65;\n        }\n        100% {\n         opacity: 1;\n        }\n      }\n  \n    `;\n  var SkeletonRender = class {\n    constructor(options) {\n      this.options = Object.assign(\n        {\n          animation: true,\n          appId: \"app\",\n          minGrayBlockWidth: 30,\n          minGrayPseudoWidth: 30\n        },\n        options\n      );\n    }\n    removeMock() {\n      const getTextWidthElement = document.querySelector(`#${MOCK_WRAPPER_ID}`);\n      if (getTextWidthElement) getTextWidthElement.remove();\n    }\n    async genSkeleton() {\n      await this.startGenSkeleton();\n      this.removeMock();\n    }\n    async startGenSkeleton() {\n      const app = document.getElementById(this.options.appId);\n      if (!app) {\n        console.error(\"\\u6839\\u5143\\u7D20\\u6CA1\\u627E\\u5230~\");\n        return false;\n      }\n      const newNode = cloneElementWithUniqueIds(app);\n      newNode.id = \"__skeleton_clone\";\n      newNode.classList.add(SKELETON_CLONE_CLASS);\n      app.style.visibility = \"hidden\";\n      document.body.prepend(newNode);\n      this.styleHandler();\n      try {\n        this.handleNode(newNode);\n      } catch (e) {\n        if (e instanceof Error) {\n          console.log(\"==genSkeleton Error==\\n\", e.message, e.stack);\n        }\n      }\n    }\n    // Initialization processing DOM\n    styleHandler() {\n      const skeletonBlockStyleEle = document.createElement(\"style\");\n      skeletonBlockStyleEle.innerText = skeletonStyle.replace(/\\n/g, \"\");\n      document.body.prepend(skeletonBlockStyleEle);\n    }\n    // Processing a single node\n    handleNode(node) {\n      if (!node) return;\n      if (isTextNode(node)) {\n        const parent = node.parentNode;\n        if (!parent.classList.contains(SKELETON_TEXT_CLASS)) {\n          const textContent = node.textContent.replace(/[\\r\\n]/g, \"\").trim();\n          if (textContent) {\n            const tmpNode = document.createElement(\"i\");\n            tmpNode.classList.add(SKELETON_TEXT_CLASS);\n            tmpNode.innerHTML = textContent;\n            node.parentNode.replaceChild(tmpNode, node);\n            this.textHandler(tmpNode);\n            return true;\n          }\n        }\n      } else if (isHtmlElement(node)) {\n        if (!inViewPort(node) || hasAttr(node, \"data-skeleton-remove\")) {\n          return removeElement(node);\n        }\n        const ignore = hasAttr(node, \"data-skeleton-ignore\") || node.tagName === \"STYLE\";\n        if (ignore) return;\n        this.beforeHandler(node);\n        this.pseudoHandler(node);\n        const tagName = node.tagName && node.tagName.toUpperCase();\n        switch (tagName) {\n          case \"SCRIPT\":\n            this.scriptHandler(node);\n            break;\n          case \"IMG\":\n            this.imgHandler(node);\n            break;\n          case \"SVG\":\n            this.svgHandler(node);\n            break;\n          // 处理input 元素\n          // 删除placeholder 和 value\n          case \"INPUT\":\n            this.inputHandler(node);\n            break;\n          // 处理button\n          // 1. 设置boxshadow为none\n          // 2. 设置元素渲染出的宽高，清空子元素\n          case \"BUTTON\":\n            this.buttonHandler(node);\n            break;\n          // 处理A标签\n          // 1. 删除href属性\n          case \"A\":\n            this.aHandler(node);\n            break;\n        }\n        if (node.childNodes && node.childNodes.length === 1 && node.childNodes[0].nodeType === Node.TEXT_NODE) {\n          this.textHandler(node);\n          return;\n        }\n        if (node.hasChildNodes()) {\n          node.childNodes.forEach((node2) => this.handleNode(node2));\n        }\n      }\n    }\n    // 处理文本\n    // 1. 获取行高\n    // 2. 根据元素高度计算渲染几行\n    // 3. 利用background-repeat 和background-size y等于一行的高度 渲染出多行的骨架屏\n    // 4. 如果是多行，则处理最后一行的对齐方式，新增一个元素，利用定位覆盖\n    textHandler(ele) {\n      const comStyle = window.getComputedStyle(ele);\n      let {\n        display,\n        lineHeight,\n        paddingTop,\n        paddingRight,\n        paddingBottom,\n        paddingLeft,\n        position: pos,\n        fontSize,\n        textAlign,\n        wordSpacing,\n        wordBreak\n      } = comStyle;\n      if (!/\\d/.test(lineHeight)) {\n        const fontSizeNum = parseInt(fontSize, 10) || 14;\n        lineHeight = `${fontSizeNum * 1.4}px`;\n      }\n      const position = [\"fixed\", \"absolute\", \"flex\"].find((p) => p === pos) ? pos : \"relative\";\n      const height = ele.offsetHeight;\n      const width = ele.offsetWidth;\n      let lineCount = (height - parseFloat(paddingTop) - parseFloat(paddingBottom)) / parseFloat(lineHeight) || 0;\n      lineCount = lineCount < 1.5 ? 1 : lineCount;\n      const textHeightRatio = 0.6;\n      ele.classList.add(SKELETON_TEXT_CLASS);\n      Object.assign(ele.style, {\n        backgroundImage: `linear-gradient(\n            transparent ${(1 - textHeightRatio) / 2 * 100}%,\n            ${MAIN_COLOR} 0%,\n            ${MAIN_COLOR} ${((1 - textHeightRatio) / 2 + textHeightRatio) * 100}%,\n            transparent 0%\n          )`,\n        backgroundSize: `100% ${px2rem(parseInt(lineHeight) * 1.1)}`,\n        position\n      });\n      this.addAnimationForElement(ele);\n      if (display === \"inline\") {\n        return;\n      }\n      if (lineCount > 1) {\n        this.addTextMask(\n          ele,\n          Object.assign(JSON.parse(JSON.stringify(comStyle)), {\n            lineHeight\n          })\n        );\n      } else {\n        const textWidth = this.getTextWidth(ele, {\n          fontSize,\n          lineHeight,\n          wordBreak,\n          wordSpacing\n        });\n        const textWidthPercent = textWidth / (width - parseInt(paddingRight, 10) - parseInt(paddingLeft, 10));\n        ele.style.backgroundSize = `${textWidthPercent * 100}% ${px2rem(parseInt(lineHeight) * 1.1)}`;\n        switch (textAlign) {\n          case \"left\":\n            break;\n          case \"right\":\n            ele.style.backgroundPositionX = \"100%\";\n            break;\n          case \"center\":\n            ele.style.backgroundPositionX = \"50%\";\n        }\n      }\n    }\n    addTextMask(paragraph, {\n      textAlign,\n      lineHeight,\n      paddingBottom,\n      paddingLeft,\n      paddingRight\n    }, maskWidthPercent = 0.5) {\n      let left;\n      let right;\n      switch (textAlign) {\n        case \"center\":\n          left = document.createElement(\"span\");\n          right = document.createElement(\"span\");\n          [left, right].forEach((mask) => {\n            Object.assign(mask.style, {\n              display: \"inline-block\",\n              width: `${maskWidthPercent / 2 * 100}%`,\n              height: lineHeight,\n              background: \"#fff\",\n              position: \"absolute\",\n              bottom: paddingBottom\n            });\n          });\n          left.style.left = paddingLeft;\n          right.style.right = paddingRight;\n          paragraph.appendChild(left);\n          paragraph.appendChild(right);\n          break;\n        case \"right\":\n          left = document.createElement(\"span\");\n          Object.assign(left.style, {\n            display: \"inline-block\",\n            width: `${maskWidthPercent * 100}%`,\n            height: lineHeight,\n            background: \"#fff\",\n            position: \"absolute\",\n            bottom: paddingBottom,\n            left: paddingLeft\n          });\n          paragraph.appendChild(left);\n          break;\n        case \"left\":\n        default:\n          right = document.createElement(\"span\");\n          Object.assign(right.style, {\n            display: \"inline-block\",\n            width: `${maskWidthPercent * 100}%`,\n            height: lineHeight,\n            background: \"#fff\",\n            position: \"absolute\",\n            bottom: paddingBottom,\n            right: paddingRight\n          });\n          paragraph.appendChild(right);\n          break;\n      }\n    }\n    getTextWidth(ele, style) {\n      const MOCK_TEXT_ID = \"skeleton-text-id\";\n      let offScreenParagraph = document.querySelector(`#${MOCK_TEXT_ID}`);\n      if (!offScreenParagraph) {\n        const wrapper = document.createElement(\"p\");\n        wrapper.id = MOCK_WRAPPER_ID;\n        offScreenParagraph = document.createElement(\"span\");\n        Object.assign(wrapper.style, {\n          width: \"10000px\",\n          position: \"absolute\",\n          top: \"0\"\n        });\n        offScreenParagraph.id = MOCK_TEXT_ID;\n        offScreenParagraph.style.visibility = \"hidden\";\n        wrapper.appendChild(offScreenParagraph);\n        document.body.appendChild(wrapper);\n      }\n      Object.assign(offScreenParagraph.style, style);\n      offScreenParagraph.innerHTML = ele.innerHTML;\n      return offScreenParagraph.getBoundingClientRect().width;\n    }\n    scriptHandler(node) {\n      removeElement(node);\n    }\n    imgHandler(node) {\n      if (node.src) {\n        if (/^data:image/.test(node.src)) {\n          return false;\n        } else if (node.src.indexOf(\n          \"https://zeekrlife-oss.oss-cn-hangzhou.aliyuncs.com/frontend\"\n        ) !== -1 || node.src.indexOf(\"https://zeekrlife-oss.zeekrlife.com/frontend\") !== -1) {\n          return false;\n        }\n      }\n      const { width, height } = node.getBoundingClientRect();\n      node.style.width = width + \"px\";\n      node.style.height = height + \"px\";\n      node.src = SMALLEST_BASE64;\n      node.style.backgroundColor = IMG_BG;\n      if (width >= 300 || height >= 300) {\n        node.classList.add(IMG_CLASS_LARGE);\n      } else if (width >= 150 || height >= 150) {\n        node.classList.add(IMG_CLASS_MID);\n      } else if (width >= 75 || height >= 75) {\n        node.classList.add(IMG_CLASS_SMALL);\n      }\n      this.addAnimationForElement(node);\n    }\n    aHandler(node) {\n      node.removeAttribute(\"href\");\n    }\n    svgHandler(node) {\n      const { width, height } = node.getBoundingClientRect();\n      if (width === 0 || height === 0 || node.getAttribute(\"aria-hidden\") === \"true\") {\n        return removeElement(node);\n      }\n      node.innerHTML = \"\";\n      Object.assign(node.style, {\n        width: px2rem(parseInt(width + \"\")),\n        height: px2rem(parseInt(height + \"\"))\n      });\n      this.addAnimationForElement(node);\n    }\n    inputHandler(node) {\n      node.removeAttribute(\"placeholder\");\n      node.value = \"\";\n    }\n    buttonHandler(node) {\n      if (!node.tagName) return;\n      node.classList.add(BUTTON_CLASS);\n      let { width, height } = window.getComputedStyle(node);\n      node.style.width = width;\n      node.style.height = height;\n      node.innerHTML = \"\";\n      this.addAnimationForElement(node);\n    }\n    /**\n     * Processing text nodes\n     * @param {*} node Node\n     * @return {Boolean} True means that processing has been completed, false means that processing still needs to be continued\n     */\n    pseudoHandler(node) {\n      if (!node.tagName) return;\n      const pseudo = checkHasPseudoEle(node);\n      if (!pseudo || !pseudo.ele) return;\n      const { ele, width } = pseudo;\n      if (width < this.options.minGrayPseudoWidth || 30) {\n        return ele.classList.add(TRANSPARENT_CLASS);\n      }\n      ele.classList.add(PSEUDO_CLASS);\n      if (this.options.animation) {\n        ele.classList.add(PSEUDO_CLASS_ANIMATION);\n      }\n    }\n    beforeHandler(node) {\n      if (!node.tagName) return;\n      if (hasAttr(node, \"data-skeleton-empty\")) {\n        emptyHandler(node);\n      }\n      const { width } = node.getBoundingClientRect();\n      const isHidden = width < this.options.minGrayBlockWidth;\n      if (isHidden) {\n        setOpacity(node);\n      }\n      const ComputedStyle = window.getComputedStyle(node);\n      if (ComputedStyle.backgroundImage !== \"none\") {\n        node.style.backgroundImage = \"none\";\n        node.style.background = MAIN_COLOR;\n        !isHidden && this.addAnimationForElement(node);\n      }\n      if (ComputedStyle.boxShadow !== \"none\") {\n        const oldBoxShadow = ComputedStyle.boxShadow;\n        const newBoxShadow = oldBoxShadow.replace(/^rgb.*\\)/, MAIN_COLOR_RGB);\n        node.style.boxShadow = newBoxShadow;\n      }\n      if (ComputedStyle.borderColor) {\n        node.style.borderColor = MAIN_COLOR;\n      }\n      const bgColor = node.getAttribute(\"data-skeleton-bgcolor\");\n      if (bgColor) {\n        node.style.backgroundColor = bgColor;\n        node.style.color = \"transparent\";\n        !isHidden && this.addAnimationForElement(node);\n      }\n    }\n    addAnimationForElement(ele) {\n      if (ele) {\n        ele.style.animation = this.options.animation ? \"skeleton-opacity-animation 1.5s ease infinite\" : \"\";\n      }\n    }\n  };\n  window.SkeletonRender = SkeletonRender;\n})();\n","export const cloneElementWithUniqueIds = (\n  element: HTMLElement,\n  prefix = \"__clone\"\n) => {\n  // 深度克隆元素\n  const clonedElement = element.cloneNode(true) as HTMLElement;\n  // 递归更新克隆元素及其子元素的 i\n  function updateIds(el: HTMLElement, parentPrefix: string) {\n    if (el.id) {\n      el.id = `${parentPrefix}-${el.id}`; // 为现有 id 添加前缀\n    }\n    Array.from(el.children).forEach((child, index) => {\n      updateIds(child as HTMLElement, `${parentPrefix}-${index}`); // 子元素的前缀基于父元素\n    });\n  }\n  updateIds(clonedElement, prefix); // 开始更新 id\n  return clonedElement;\n};\n// Delete element\nexport const removeElement = (ele: HTMLElement) => {\n  const parent = ele.parentNode;\n  if (parent) {\n    parent.removeChild(ele);\n  }\n};\n\n// sleep function\nexport const sleep = (ms: number) => {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n};\n\n// Check if the node is in the first screen\nexport const inViewPort = (ele: HTMLElement) => {\n  try {\n    const rect = ele.getBoundingClientRect();\n    return rect.top < window.innerHeight && rect.left < window.innerWidth;\n  } catch (e) {\n    return true;\n  }\n};\n\n// Determine if the node has attributes\nexport const hasAttr = (ele: HTMLElement, attr: string) => {\n  try {\n    return ele.hasAttribute(attr);\n  } catch (e) {\n    return false;\n  }\n};\n\n// Set node transparency\nexport const setOpacity = (ele: HTMLElement) => {\n  if (ele.style) {\n    // @ts-ignore\n    ele.style.opacity = 0;\n  }\n};\n\n// Unit conversion px -> rem\nexport const px2rem = (px: number | string) => {\n  const pxValue = typeof px === \"string\" ? parseInt(px, 10) : px;\n  const htmlElementFontSize = window.getComputedStyle(\n    document.documentElement\n  ).fontSize;\n\n  return `${pxValue / parseInt(htmlElementFontSize, 10)}rem`;\n};\n\nexport const emptyHandler = (node: HTMLElement) => {\n  node.innerHTML = \"\";\n  let classNameArr = (node.className && node.className.split(\" \")) || [];\n  classNameArr = classNameArr.map((item) => {\n    return \".\" + item;\n  });\n  const className = classNameArr.join(\"\");\n  const id = node.id ? \"#\" + node.id : \"\";\n  const query = className || id;\n\n  if (!query) return;\n\n  let styleSheet;\n\n  for (const item of document.styleSheets) {\n    if (!item.href) {\n      styleSheet = item;\n      break;\n    }\n  }\n\n  try {\n    styleSheet &&\n      styleSheet.insertRule(\n        `${query}::before{content:'' !important;background:none !important;}`,\n        0\n      );\n    styleSheet &&\n      styleSheet.insertRule(\n        `${query}::after{content:'' !important;background:none !important;}`,\n        0\n      );\n  } catch (e) {\n    console.log(\"handleEmptyNode Error: \", JSON.stringify(e));\n  }\n};\n\n// Check the element pseudo-class to return the corresponding element and width\nexport const checkHasPseudoEle = (ele: HTMLElement) => {\n  if (!ele) return false;\n\n  const beforeComputedStyle = window.getComputedStyle(ele, \"::before\");\n  const beforeContent = beforeComputedStyle.getPropertyValue(\"content\");\n  const beforeWidth =\n    parseFloat(beforeComputedStyle.getPropertyValue(\"width\")) || 0;\n  const hasBefore = beforeContent && beforeContent !== \"none\";\n\n  const afterComputedStyle = window.getComputedStyle(ele, \"::after\");\n  const afterContent = afterComputedStyle.getPropertyValue(\"content\");\n  const afterWidth =\n    parseFloat(afterComputedStyle.getPropertyValue(\"width\")) || 0;\n  const hasAfter = afterContent && afterContent !== \"none\";\n\n  const width = Math.max(beforeWidth, afterWidth);\n\n  if (hasBefore || hasAfter) {\n    return { hasBefore, hasAfter, ele, width };\n  }\n  return false;\n};\nexport const isTextNode = (node:  HTMLElement | Node): node is Text => {\n  return node.nodeType === Node.TEXT_NODE && node.nodeValue !== \"\";\n};\nexport const isHtmlElement = (\n  node: HTMLElement | Node\n): node is HTMLElement => {\n  return node.nodeType === Node.ELEMENT_NODE;\n};\n","import {\n  cloneElementWithUniqueIds,\n  removeElement,\n  px2rem,\n  sleep,\n  hasAttr,\n  inViewPort,\n  setOpacity,\n  emptyHandler,\n  checkHasPseudoEle,\n  isHtmlElement,\n  isTextNode\n} from \"./utils/skeletonUtil\";\nconst SKELETON_CLONE_CLASS = \"skeleton_clone\";\nconst MOCK_WRAPPER_ID = \"skeleton-text-wrapper-id\";\n// Skeleton main color\nconst MAIN_COLOR = \"#EEEEEE\";\nconst MAIN_COLOR_RGB = \"rgb(238, 238, 238)\";\n// Pseudo-class style\nconst PSEUDO_CLASS = \"sk-pseudo\";\nconst PSEUDO_CLASS_ANIMATION = \"sk-pseudo-animation\";\n// button style\nconst BUTTON_CLASS = \"sk-button\";\n// Transparent style\nconst TRANSPARENT_CLASS = \"sk-transparent\";\n// Transparent 1 pixel image\nconst SMALLEST_BASE64 =\n  \"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\";\nconst IMG_BASE64_LARGE =\n  \"data:image/image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAAopJREFUeF7tm1FyAyEIhs3JWk/W5mSmJ2tDRjtmBwUU3HXXPGUmG8P/gYJobu7ir9vF9TsWgBDCp3PuK8KC90d/3cFA7/03ZSgJIIQQnHMziMa03ikIVQBP7UAweZ6CedTPH/5JoWRcEcBJxCfdwOCBQZAAgAEgpNCBjuL+bL3Kp20xCmoAfjeiihSPIj7ZESHA2pVe/QC89+SCeSQQIYQ3B5bsZ0fAAiCIAKRuYOdlrSjaLQKIuoHMy1MDYKbOal6eFgBTPJmXzwTgVTdEQVBNsvLyzACKdYMkL2sAwKLRPA0ii99/4YQAgJ2aSV1Rmop7AKhNAZNsUFuHRgCAOZ6Xn7VoVgdALcLmAEAts3cwXHxsjqBTTr0UJjyhXgNQns/y7hgAMRJSKwrSX9o+q2+lK+Ih/b41coZMAY0Uxh2jJh7aYLvtBbgCep6jxMcoPOd2mCP+tAC44k8JQCJ+OIBSI/J5NvFD9eU5a4FU/FAAWJ2PiGouflrEDwPALUIyICIQreKHAGgQnwcGCaJHvDkAjnFMQCgIzvjU2mFWCEmNk4KQjl8CYQKgxzgmiJIecspsv6gOIPb3sJNikXENIETjJxAWADDvNBmX7Ripo/fm88gRAJrF5yRjRHxsu8a9J9HWAFTEUyt5z+eWAA4v3qQOiN6YQrwVgGnEmwCwOsjomee176qvAQuA0VHWigAjAmsKrEtS65ZY97nA9pJ088bEaJoXh9W6ILEFMPNV2WIRVzsdlpz3j3ay9PfkAGI5OfN/BRKkaglP3tNp6OBIvWP5PHkfgQSQdW/gLdXBsRTDHVt0H4EFgPvLMz63AMzoNU2bVwRo0pxxrBUBM3pN0+YVAZo0Zxzr8hHwB9VpX1/uYOP2AAAAAElFTkSuQmCC\";\nconst IMG_BASE64_MID =\n  \"data:image/image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAT1JREFUWEftlm0OwyAIhu3JNk+29WRsJ9tKowapH4AxXbI26T+Fx5dXcHEnfwvPDwBP59zNOXefwLZ67zF++jKAkPwxITENmUFwgE9YeSAdhSKHe/lNhhivCOC9P5RmFAD3A8B+QBpfDMC8YVLIDFDxhhpiBCB5I5QCjZrVUlKiEQAI13IlAFktewCwyRivttoDoyWgyUdNuEu/GfnNG0pNAZIc9+3NTa1AT15Jcrz7Zg9YAOjJY+MxAwAASoc/Oh+lbH6l5OZGxA3Ua9W15CYAZiCMwSdk1oxaydUADRlxnPKJGcsSy5SGDa2V2APhqvWCFUHopONG0QDgXlGr1RhUAyBK3rsNZgV+8j2gPW1pvbgEf61AmvvSaSctDR3prWlYutvSHNJ19Wd5aJezIIrviCnPb6kUuO4CuBT4AqsEKzBFERGIAAAAAElFTkSuQmCC\";\nconst IMG_BASE64_SMALL =\n  \"data:image/image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAMdJREFUOE+lU4ENwjAM8z7hE8gl8AnwCVyS8QmngKOkCt0yFai0Ve0Sx7GzCb5U9QCAz9ASkQsDJ75UlYc9gMdQNnB+x4qIzBmAN4YabOLcg3pBi18AJDZsx6qsANwAPCsAJpIi92vPwtlpfKtaYCtzXz0l30sGocFGsoRbixZYlRr6bo4wKFU2TSoRdwCOIVwEub0fglYAzdusOquvtGN25xZoCy9OI4O0OQe/AoT334yyzYjNQfofRggwps1IAxjN7OP+BngBsiWUEe5m32cAAAAASUVORK5CYII=\";\nconst IMG_BG = \"#dddddd\";\n// text class\nconst SKELETON_TEXT_CLASS = \"skeleton-text-block-mark\";\nconst IMG_CLASS_SMALL = \"sk-img-small\";\nconst IMG_CLASS_MID = \"sk-img-mid\";\nconst IMG_CLASS_LARGE = \"sk-img-large\";\n\nconst skeletonStyle = `\n\n      .${SKELETON_CLONE_CLASS}{\n        position:fixed;\n        left:0;\n        right:0;\n        top:0;\n        bottom:0;\n        z-index:1000000;\n        width:100vw;\n        height:100vh;\n      }\n\n      .${SKELETON_TEXT_CLASS},\n      .${SKELETON_TEXT_CLASS} * {\n        background-origin: content-box;\n        background-clip: content-box;\n        background-color: transparent;\n        color: transparent !important;\n        background-repeat: repeat-y;\n      }\n  \n      .${PSEUDO_CLASS}::before,\n      .${PSEUDO_CLASS}::after {\n        background: ${MAIN_COLOR} !important;\n        background-image: none !important;\n        color: transparent !important;\n        border-color: transparent !important;\n      }\n      .${PSEUDO_CLASS_ANIMATION}::before,\n      .${PSEUDO_CLASS_ANIMATION}::after {\n          animation: skeleton-opacity-animation 1.5s ease infinite !important;\n      }\n  \n      .${BUTTON_CLASS} {\n        box-shadow: none !important;\n      }\n\n      .${IMG_CLASS_SMALL}{\n         background-image: url(${IMG_BASE64_SMALL}) !important;\n         background-repeat:no-repeat !important;\n         background-position: center !important;\n      }\n      .${IMG_CLASS_MID}{\n         background-image: url(${IMG_BASE64_MID}) !important;\n         background-repeat:no-repeat !important;\n         background-position: center !important;\n      }\n      .${IMG_CLASS_LARGE}{\n         background-image: url(${IMG_BASE64_LARGE}) !important;\n         background-repeat:no-repeat !important;\n         background-position: center !important;\n      }\n  \n      .${TRANSPARENT_CLASS}::before,\n      .${TRANSPARENT_CLASS}::after {\n        opacity: 0 !important;\n      }\n      \n      @keyframes skeleton-opacity-animation {\n        0% {\n          opacity: 1;\n        }\n        30% {\n          opacity: 0.65;\n        }\n        100% {\n         opacity: 1;\n        }\n      }\n  \n    `;\n// List item Tag\nconst LIST_ITEM_TAG = [\"LI\", \"DT\", \"DD\"];\ntype SkeletonOption = PrerenderSkeletonOption[\"routes\"][number];\nexport default class SkeletonRender {\n  private options: Required<SkeletonOption>;\n  constructor(options: SkeletonOption) {\n    this.options = Object.assign(\n      {\n        animation: true,\n        appId: \"app\",\n        minGrayBlockWidth: 30,\n        minGrayPseudoWidth: 30,\n      },\n      options\n    );\n  }\n  removeMock() {\n    // 处理完成之后删除多余的10000px的 用来检测文本节点长度而生成的多余节点\n    const getTextWidthElement = document.querySelector(`#${MOCK_WRAPPER_ID}`);\n    if (getTextWidthElement) getTextWidthElement.remove();\n  }\n  async genSkeleton() {\n    await this.startGenSkeleton();\n    this.removeMock();\n  }\n  async startGenSkeleton() {\n    const app = document.getElementById(this.options.appId);\n    if (!app) {\n      console.error(\"根元素没找到~\");\n      return false;\n    }\n    const newNode = cloneElementWithUniqueIds(app);\n    newNode.id = \"__skeleton_clone\";\n    newNode.classList.add(SKELETON_CLONE_CLASS);\n    app.style.visibility = \"hidden\";\n    document.body.prepend(newNode);\n    // 初始化骨架屏样式\n    this.styleHandler();\n    try {\n      this.handleNode(newNode);\n    } catch (e) {\n      if (e instanceof Error) {\n        console.log(\"==genSkeleton Error==\\n\", e.message, e.stack);\n      }\n    }\n  }\n  // Initialization processing DOM\n  styleHandler() {\n    const skeletonBlockStyleEle = document.createElement(\"style\");\n    skeletonBlockStyleEle.innerText = skeletonStyle.replace(/\\n/g, \"\");\n    document.body.prepend(skeletonBlockStyleEle);\n  }\n  // Processing a single node\n  handleNode(node: HTMLElement | Node) {\n    if (!node) return;\n    // 如果是文本节点\n    if (isTextNode(node)) {\n      const parent = node.parentNode as HTMLElement;\n      // Determine if it has been processed\n      if (!parent.classList.contains(SKELETON_TEXT_CLASS)) {\n        // It is plain text itself and needs to be replaced with a node\n        const textContent = node.textContent!.replace(/[\\r\\n]/g, \"\").trim();\n        if (textContent) {\n          const tmpNode = document.createElement(\"i\");\n          tmpNode.classList.add(SKELETON_TEXT_CLASS);\n          tmpNode.innerHTML = textContent;\n          node.parentNode!.replaceChild(tmpNode, node);\n          this.textHandler(tmpNode);\n          return true;\n        }\n      }\n    }\n    // 是元素节点\n    else if (\n      isHtmlElement(node)\n    ) {\n      // Delete elements that are not in first screen, or marked for deletion\n      if (!inViewPort(node) || hasAttr(node, \"data-skeleton-remove\")) {\n        return removeElement(node);\n      }\n\n      // Handling elements that are ignored by user tags -> End\n      const ignore =\n        hasAttr(node, \"data-skeleton-ignore\") || node.tagName === \"STYLE\";\n      if (ignore) return;\n\n      // 处理默认样式\n      // 1. 有data-skeleton-empty属性的清空子元素，和伪类元素的背景色\n      // 2 如果元素宽度小于最小宽度，则透明度设置为0\n      // 3 如果有backgroundImage背景图片的话，则把背景图设置为none，设置默认背景色 ,如果配置options有动画属性，则给元素添加动画\n      // 4 如果有阴影的话，替换为默认阴影\n      // 5 如果有边框的话，替换为默认边框\n      // 6 如果有自定义data-skeleton-bgcolor背景色的话，则设置自定义背景色，并把颜色color设置为透明，如果配置options有动画属性，则给元素添加动画\n      this.beforeHandler(node);\n      // 处理伪元素\n      // 如果伪元素宽度小于最小宽度，则透明度设置为0，否则的话设置为默认背景色、背景图片为none、默认边框颜色、把颜色color设置为透明,如果配置options有动画属性，则给元素添加动画\n      this.pseudoHandler(node);\n\n      const tagName = node.tagName && node.tagName.toUpperCase();\n      switch (tagName) {\n        case \"SCRIPT\":\n          // 如果是script标签的话，则删除元素\n          this.scriptHandler(node);\n          break;\n        case \"IMG\":\n          // img元素处理\n          // 1. 如果是base64或则静态图 不处理直接返回\n          // 2. 这是渲染出来的固定宽高，设置src为空的base64\n          // 3. 设置图片默认的背景色和backgroundImage背景图片\n          this.imgHandler(node as HTMLImageElement);\n          break;\n        case \"SVG\":\n          // svg处理\n          // 1. 如果aria-hidden属性为true，或则宽高为0，则删除元素\n          // 2. 清除元素centent\n          // 3. 设置元素渲染后的宽高\n          this.svgHandler(node as HTMLImageElement);\n          break;\n        // 处理input 元素\n        // 删除placeholder 和 value\n        case \"INPUT\":\n          this.inputHandler(node as HTMLInputElement);\n          break;\n        // 处理button\n        // 1. 设置boxshadow为none\n        // 2. 设置元素渲染出的宽高，清空子元素\n        case \"BUTTON\": // Button processing ends once\n          this.buttonHandler(node as HTMLButtonElement);\n          break;\n          // 处理A标签\n          // 1. 删除href属性\n        case \"A\": // A label processing is placed behind to prevent IMG from displaying an exception\n          this.aHandler(node);\n          break;\n      }\n      // 处理子节点为纯文本节点元素 <p>xxx</p>\n      if (\n        node.childNodes &&\n        node.childNodes.length === 1 &&\n        node.childNodes[0].nodeType === Node.TEXT_NODE\n      ) {\n        this.textHandler(node);\n        return;\n      }\n      if (node.hasChildNodes()) {\n        node.childNodes.forEach((node) => this.handleNode(node));\n      }\n    }\n  }\n  // 处理文本\n  // 1. 获取行高\n  // 2. 根据元素高度计算渲染几行\n  // 3. 利用background-repeat 和background-size y等于一行的高度 渲染出多行的骨架屏\n  // 4. 如果是多行，则处理最后一行的对齐方式，新增一个元素，利用定位覆盖\n  textHandler(ele: HTMLElement) {\n    // Handling text styles\n    const comStyle = window.getComputedStyle(ele);\n    let {\n      display,\n      lineHeight,\n      paddingTop,\n      paddingRight,\n      paddingBottom,\n      paddingLeft,\n      position: pos,\n      fontSize,\n      textAlign,\n      wordSpacing,\n      wordBreak,\n    } = comStyle;\n    if (!/\\d/.test(lineHeight)) {\n      const fontSizeNum = parseInt(fontSize, 10) || 14;\n      lineHeight = `${fontSizeNum * 1.4}px`;\n    }\n    const position = [\"fixed\", \"absolute\", \"flex\"].find((p) => p === pos)\n      ? pos\n      : \"relative\";\n\n    const height = ele.offsetHeight;\n    const width = ele.offsetWidth;\n    // Round down\n    let lineCount =\n      (height - parseFloat(paddingTop) - parseFloat(paddingBottom)) /\n        parseFloat(lineHeight) || 0;\n\n    lineCount = lineCount < 1.5 ? 1 : lineCount;\n\n    const textHeightRatio = 0.6; // Default\n\n    // Add text block class name tag\n    ele.classList.add(SKELETON_TEXT_CLASS);\n\n    Object.assign(ele.style, {\n      backgroundImage: `linear-gradient(\n            transparent ${((1 - textHeightRatio) / 2) * 100}%,\n            ${MAIN_COLOR} 0%,\n            ${MAIN_COLOR} ${\n        ((1 - textHeightRatio) / 2 + textHeightRatio) * 100\n      }%,\n            transparent 0%\n          )`,\n      backgroundSize: `100% ${px2rem(parseInt(lineHeight) * 1.1)}`,\n      position,\n    });\n    this.addAnimationForElement(ele)\n    // add white mask\n    if(display==='inline'){\n      return\n    }\n    if (lineCount > 1) {\n      this.addTextMask(\n        ele,\n        Object.assign(JSON.parse(JSON.stringify(comStyle)), {\n          lineHeight,\n        })\n      );\n    } else {\n      const textWidth = this.getTextWidth(ele, {\n        fontSize,\n        lineHeight,\n        wordBreak,\n        wordSpacing,\n      });\n      const textWidthPercent =\n        textWidth /\n        (width -\n          parseInt(paddingRight, 10) -\n          parseInt(paddingLeft, 10));\n      ele.style.backgroundSize = `${textWidthPercent * 100}% ${px2rem(parseInt(lineHeight) * 1.1)}`;\n      switch (textAlign) {\n        case \"left\":\n          break;\n        case \"right\":\n          ele.style.backgroundPositionX = \"100%\";\n          break;\n        case \"center\":\n          ele.style.backgroundPositionX = \"50%\";\n      }\n    }\n  }\n  addTextMask(\n    paragraph: HTMLElement,\n    {\n      textAlign,\n      lineHeight,\n      paddingBottom,\n      paddingLeft,\n      paddingRight,\n    }: {\n      textAlign: string;\n      lineHeight: string;\n      paddingBottom: string;\n      paddingLeft: string;\n      paddingRight: string;\n    },\n    maskWidthPercent = 0.5\n  ) {\n    let left;\n    let right;\n    switch (textAlign) {\n      case \"center\":\n        left = document.createElement(\"span\");\n        right = document.createElement(\"span\");\n        [left, right].forEach((mask) => {\n          Object.assign(mask.style, {\n            display: \"inline-block\",\n            width: `${(maskWidthPercent / 2) * 100}%`,\n            height: lineHeight,\n            background: \"#fff\",\n            position: \"absolute\",\n            bottom: paddingBottom,\n          });\n        });\n        left.style.left = paddingLeft;\n        right.style.right = paddingRight;\n        paragraph.appendChild(left);\n        paragraph.appendChild(right);\n        break;\n      case \"right\":\n        left = document.createElement(\"span\");\n        Object.assign(left.style, {\n          display: \"inline-block\",\n          width: `${maskWidthPercent * 100}%`,\n          height: lineHeight,\n          background: \"#fff\",\n          position: \"absolute\",\n          bottom: paddingBottom,\n          left: paddingLeft,\n        });\n        paragraph.appendChild(left);\n        break;\n      case \"left\":\n      default:\n        right = document.createElement(\"span\");\n        Object.assign(right.style, {\n          display: \"inline-block\",\n          width: `${maskWidthPercent * 100}%`,\n          height: lineHeight,\n          background: \"#fff\",\n          position: \"absolute\",\n          bottom: paddingBottom,\n          right: paddingRight,\n        });\n        paragraph.appendChild(right);\n        break;\n    }\n  }\n\n  getTextWidth(\n    ele: HTMLElement,\n    style: {\n      fontSize: string;\n      lineHeight: string;\n      wordBreak: string;\n      wordSpacing: string;\n    }\n  ) {\n    const MOCK_TEXT_ID = \"skeleton-text-id\";\n    let offScreenParagraph = document.querySelector(`#${MOCK_TEXT_ID}`);\n    if (!offScreenParagraph) {\n      const wrapper = document.createElement(\"p\");\n      wrapper.id = MOCK_WRAPPER_ID;\n      offScreenParagraph = document.createElement(\"span\");\n      Object.assign(wrapper.style, {\n        width: \"10000px\",\n        position: \"absolute\",\n        top: \"0\",\n      });\n      offScreenParagraph.id = MOCK_TEXT_ID;\n      (offScreenParagraph as HTMLElement).style.visibility = \"hidden\";\n      wrapper.appendChild(offScreenParagraph);\n      document.body.appendChild(wrapper);\n    }\n    Object.assign((offScreenParagraph as HTMLElement).style, style);\n    // ele.childNodes && setStylesInNode(ele.childNodes);\n    offScreenParagraph.innerHTML = ele.innerHTML;\n    return offScreenParagraph.getBoundingClientRect().width;\n  }\n\n  scriptHandler(node: HTMLElement) {\n    removeElement(node);\n  }\n  imgHandler(node: HTMLImageElement) {\n    if (node.src) {\n      // 如果是base64，不处理\n      if (/^data:image/.test(node.src)) {\n        return false;\n      }\n      // 如果是oss静态图也不处理\n      else if (\n        node.src.indexOf(\n          \"https://zeekrlife-oss.oss-cn-hangzhou.aliyuncs.com/frontend\"\n        ) !== -1 ||\n        node.src.indexOf(\"https://zeekrlife-oss.zeekrlife.com/frontend\") !== -1\n      ) {\n        return false;\n      }\n    }\n    const { width, height } = node.getBoundingClientRect();\n    node.style.width = width + \"px\";\n    node.style.height = height + \"px\";\n    node.src = SMALLEST_BASE64;\n    node.style.backgroundColor = IMG_BG;\n    if (width >= 300 || height >= 300) {\n      node.classList.add(IMG_CLASS_LARGE);\n    } else if (width >= 150 || height >= 150) {\n      node.classList.add(IMG_CLASS_MID);\n    } else if (width >= 75 || height >= 75) {\n      node.classList.add(IMG_CLASS_SMALL);\n    }\n    this.addAnimationForElement(node);\n  }\n  aHandler(node: HTMLElement) {\n    node.removeAttribute(\"href\");\n  }\n  svgHandler(node: HTMLImageElement) {\n    const { width, height } = node.getBoundingClientRect();\n    // Remove elements if they are not visible\n    if (\n      width === 0 ||\n      height === 0 ||\n      node.getAttribute(\"aria-hidden\") === \"true\"\n    ) {\n      return removeElement(node);\n    }\n\n    // Clear node centent\n    node.innerHTML = \"\";\n\n    // Set style\n    Object.assign(node.style, {\n      width: px2rem(parseInt(width + \"\")),\n      height: px2rem(parseInt(height + \"\")),\n    });\n    this.addAnimationForElement(node);\n  }\n  inputHandler(node: HTMLInputElement) {\n    node.removeAttribute(\"placeholder\");\n    node.value = \"\";\n  }\n  buttonHandler(node: HTMLButtonElement) {\n    if (!node.tagName) return;\n\n    node.classList.add(BUTTON_CLASS);\n\n    let { width, height } = window.getComputedStyle(node);\n\n    node.style.width = width;\n    node.style.height = height;\n\n    // Clear button content\n    node.innerHTML = \"\";\n    this.addAnimationForElement(node);\n  }\n  /**\n   * Processing text nodes\n   * @param {*} node Node\n   * @return {Boolean} True means that processing has been completed, false means that processing still needs to be continued\n   */\n\n  pseudoHandler(node: HTMLElement) {\n    if (!node.tagName) return;\n\n    const pseudo = checkHasPseudoEle(node);\n\n    if (!pseudo || !pseudo.ele) return;\n\n    const { ele, width } = pseudo;\n\n    // Width is less than the hiding threshold\n    if (width < this.options.minGrayPseudoWidth || 30) {\n      return ele.classList.add(TRANSPARENT_CLASS);\n    }\n\n    ele.classList.add(PSEUDO_CLASS);\n    if (this.options.animation) {\n      ele.classList.add(PSEUDO_CLASS_ANIMATION);\n    }\n  }\n  beforeHandler(node: HTMLElement) {\n    if (!node.tagName) return;\n    // Handling empty elements of user tags\n    if (hasAttr(node, \"data-skeleton-empty\")) {\n      emptyHandler(node);\n    }\n\n    // Width is less than the hiding threshold\n    const { width } = node.getBoundingClientRect();\n    const isHidden = width < this.options.minGrayBlockWidth;\n    if (isHidden) {\n      setOpacity(node);\n    }\n\n    const ComputedStyle = window.getComputedStyle(node);\n\n    // The background image is changed to the main color\n    if (ComputedStyle.backgroundImage !== \"none\") {\n      node.style.backgroundImage = \"none\";\n      node.style.background = MAIN_COLOR;\n      // 增加动画效果\n      !isHidden && this.addAnimationForElement(node);\n    }\n\n    // The Shadow is changed to the main color\n    if (ComputedStyle.boxShadow !== \"none\") {\n      const oldBoxShadow = ComputedStyle.boxShadow;\n      const newBoxShadow = oldBoxShadow.replace(/^rgb.*\\)/, MAIN_COLOR_RGB);\n      node.style.boxShadow = newBoxShadow;\n    }\n\n    // The border is changed to the main color\n    if (ComputedStyle.borderColor) {\n      node.style.borderColor = MAIN_COLOR;\n    }\n\n    // Set the background color of the user class\n    const bgColor = node.getAttribute(\"data-skeleton-bgcolor\");\n    if (bgColor) {\n      node.style.backgroundColor = bgColor;\n      node.style.color = \"transparent\";\n      // 增加动画效果\n      !isHidden && this.addAnimationForElement(node);\n    }\n  }\n  addAnimationForElement(ele: HTMLElement) {\n    if (ele) {\n      ele.style.animation = this.options.animation\n        ? \"skeleton-opacity-animation 1.5s ease infinite\"\n        : \"\";\n    }\n  }\n}\nwindow.SkeletonRender = SkeletonRender;\n"]}